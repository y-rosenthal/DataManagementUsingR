<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>31&nbsp; 31.  Inner Joins. – Data Management With R (latest version)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sql0030-sqlFunctions_aggregateFunctions_groupBy_having-v019.html" rel="next">
<link href="./sql0010-introToSql-v023.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">

<meta http-equiv="Pragma" content="no-cache">

<meta http-equiv="Expires" content="0">
<script src="yrstuff.js"></script>


<link rel="stylesheet" href="yrStyles-main-v001.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql0014-theBooksDatabase-v001.html">Relational databases and SQL</a></li><li class="breadcrumb-item"><a href="./sql0035-workingWithMultipleTables-v012.html"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title"><yrchapternumber>31. </yrchapternumber> Inner Joins.</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Management With R (latest version)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><yrchapternumber></yrchapternumber> Intro</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Some computer basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro00100-operatingSystems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title"><yrchapternumber>1. </yrchapternumber> What is an "operating system"</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro00120-files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title"><yrchapternumber>2. </yrchapternumber> Working with files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro00130-chromeExtensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title"><yrchapternumber>3. </yrchapternumber> Chrome Extensions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Into to Coding With AI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ai-000100-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title"><yrchapternumber>4. </yrchapternumber> AI in Everyday Use</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aiCoding00100-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title"><yrchapternumber>5. </yrchapternumber> Coding with AI - an overview</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Intro to R packages</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000022-InstallingRPackages-v003.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title"><yrchapternumber>6. </yrchapternumber> Intro to R packages</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Intro to Quarto</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000017-introToQuarto-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title"><yrchapternumber>7. </yrchapternumber> Intro to Quarto</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Intro to tidyverse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0400050-whatIsTidyverse-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><yrchapternumber>8. </yrchapternumber> What is the "tidyverse"</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0400050-tibbles-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><yrchapternumber>9. </yrchapternumber> tibbles and tribbles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0400100-usingPipes-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><yrchapternumber>10. </yrchapternumber> Using pipes, i.e. %&gt;% and |&gt;</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0400200-stringr-tutorials-v003.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title"><yrchapternumber>11. </yrchapternumber> stringr tutorial</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Working with files</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000055-workingWithFiles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title"><yrchapternumber>12. </yrchapternumber> Working with files</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">JSON data and APIs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000075-whatIsJsonData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title"><yrchapternumber>13. </yrchapternumber> Intro to JSON data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000080-editingAndValidatingJsonFiles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title"><yrchapternumber>14. </yrchapternumber> Creating, editing and validating JSON files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000085-jsonDataTypes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title"><yrchapternumber>15. </yrchapternumber> DATA TYPES IN JSON</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000090-usingJsonInR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title"><yrchapternumber>16. </yrchapternumber> Using JSON in R with jsonlite package</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000093-jsonParsingPractice-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title"><yrchapternumber>17. </yrchapternumber> JSON Parsing Practice in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment-api-0000100-weatherDataApi-v002.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title"><yrchapternumber>18. </yrchapternumber> assignment - weather API</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Regular Expressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0200200-a-introToRegularExpressions-v036.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title"><yrchapternumber>19. </yrchapternumber> regular expressions (regex)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./000260-PracticeWithRegulaExpressions-v003.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title"><yrchapternumber>20. </yrchapternumber> Practice with Regular Expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0990100-cleaningData-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title"><yrchapternumber>21. </yrchapternumber> "Cleaning" data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Bash</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000011-WhatIsACli-v010.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title"><yrchapternumber>22. </yrchapternumber> Intro to Command Line Interfaces (CLIs)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000013-HowToRunTheBashShellCli-v011.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title"><yrchapternumber>23. </yrchapternumber> How to run the Bash Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000025-introToBash-v007.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title"><yrchapternumber>24. </yrchapternumber> Working with the Bash Shell.</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">Intro to dplyr</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0500100-a-tdyvrsDplyr-v005.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title"><yrchapternumber>25. </yrchapternumber> dplyr - getting and viewing the data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0500100-b-tdyvrsDplyr-v005.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title"><yrchapternumber>26. </yrchapternumber> dplyr verbs - select, filter, etc.</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">Relational databases and SQL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0014-theBooksDatabase-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title"><yrchapternumber>27. </yrchapternumber> Get the data - "books database" and other tables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0006-introToDatabases-v023.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title"><yrchapternumber>28. </yrchapternumber>  "databases" and "database management systems"</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0500400-sqlSelectIntro-v003.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title"><yrchapternumber>29. </yrchapternumber> Intro to SQL Select ***(assumes some knowledge of dplyr)***</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0010-introToSql-v023.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title"><yrchapternumber>30. </yrchapternumber> Intro to Relational Databases and SQL ***(no dplyr required)***</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0035-workingWithMultipleTables-v012.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title"><yrchapternumber>31. </yrchapternumber> Inner Joins.</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0030-sqlFunctions_aggregateFunctions_groupBy_having-v019.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title"><yrchapternumber>32. </yrchapternumber> aggregate functions, group by, having</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0040-a-crossJoin-leftJoin-subquery-selfJoins-v023.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title"><yrchapternumber>33. </yrchapternumber> more joins (cross/left/right/full), subqueries, set operations, case, self joins</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0050-commonTableExpressions-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title"><yrchapternumber>34. </yrchapternumber> Common Table Expressions (CTE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0200-otherSqlCommands-v002.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title"><yrchapternumber>35. </yrchapternumber> other commands: update/delete, create/drop/insert</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0900-sqlWindowFunctions-v002.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title"><yrchapternumber>36. </yrchapternumber> SQL "window" functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0950-workingWithDatabasesInR-v010.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title"><yrchapternumber>37. </yrchapternumber> Working directly with databases in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0600100-introToDb-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title"><yrchapternumber>38. </yrchapternumber> What is a Database?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql3000-sqlQuestions-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title"><yrchapternumber>sqlQstns Database Questions (and Answers)</yrchapternumber></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">Git and Github</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./github-000700-markdownGithubVsQuarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">GitHub Markdown vs.&nbsp;Quarto (.qmd) Comparison</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="true">
 <span class="menu-text">visualizations with ggplot2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./050050-tdyvrsGgplot2-v0001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title"><yrchapternumber>39. </yrchapternumber> Intro to ggplot2</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true">
 <span class="menu-text">Web Scraping</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./web-000300-internetArchitecture-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title"><yrchapternumber>40. </yrchapternumber> How a webpage gets to your browser</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./web-000400-webscrapingContinued-015.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title"><yrchapternumber>41. </yrchapternumber> Web Scraping with R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./web-000130-WebscrapingJavascriptSites-v003.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title"><yrchapternumber>42. </yrchapternumber> Scraping Dynamic (JavaScript) Websites</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./web-000420-practiceWithWebScraping-v001-ANSWERS-v002.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title"><yrchapternumber>43. </yrchapternumber> CSS Selector Questions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000100-topics-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title"><yrchapternumber>44. </yrchapternumber> Topics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000200-bibliography-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title"><yrchapternumber>45. </yrchapternumber> Bibliography</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000300-whereToFindDatasets-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title"><yrchapternumber>46. </yrchapternumber> Where to find datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000310-whereToFindApis-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title"><yrchapternumber>47. </yrchapternumber> Where to find APIs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0999000-toDo-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title"><yrchapternumber>48. </yrchapternumber> Additional topics</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#importing-the-data-into-r" id="toc-importing-the-data-into-r" class="nav-link active" data-scroll-target="#importing-the-data-into-r"><span class="header-section-number">31.1</span> Importing the data into R</a></li>
  <li><a href="#intro-to-joining-two-tables" id="toc-intro-to-joining-two-tables" class="nav-link" data-scroll-target="#intro-to-joining-two-tables"><span class="header-section-number">31.2</span> Intro to “JOIN”ing two tables</a>
  <ul class="collapse">
  <li><a href="#overview-of-the-customers-and-orders-tables" id="toc-overview-of-the-customers-and-orders-tables" class="nav-link" data-scroll-target="#overview-of-the-customers-and-orders-tables"><span class="header-section-number">31.2.1</span> Overview of the customers and orders tables</a></li>
  </ul></li>
  <li><a href="#primary-keys-and-foreign-keys" id="toc-primary-keys-and-foreign-keys" class="nav-link" data-scroll-target="#primary-keys-and-foreign-keys"><span class="header-section-number">31.3</span> “Primary Keys” and “Foreign Keys”</a>
  <ul class="collapse">
  <li><a href="#more-about-the-customers-and-orders-tables" id="toc-more-about-the-customers-and-orders-tables" class="nav-link" data-scroll-target="#more-about-the-customers-and-orders-tables"><span class="header-section-number">31.3.1</span> More about the customers and orders tables</a></li>
  <li><a href="#joining-customers-and-orders-into-a-single-output" id="toc-joining-customers-and-orders-into-a-single-output" class="nav-link" data-scroll-target="#joining-customers-and-orders-into-a-single-output"><span class="header-section-number">31.3.2</span> JOINing customers and orders into a single output</a></li>
  </ul></li>
  <li><a href="#one-to-many-relationships" id="toc-one-to-many-relationships" class="nav-link" data-scroll-target="#one-to-many-relationships"><span class="header-section-number">31.4</span> One to Many relationships</a></li>
  <li><a href="#many-to-many-relationships" id="toc-many-to-many-relationships" class="nav-link" data-scroll-target="#many-to-many-relationships"><span class="header-section-number">31.5</span> Many to Many relationships</a></li>
  <li><a href="#practice---one-to-many-or-many-to-many" id="toc-practice---one-to-many-or-many-to-many" class="nav-link" data-scroll-target="#practice---one-to-many-or-many-to-many"><span class="header-section-number">31.6</span> Practice - “one to many” or “many to many”?</a></li>
  <li><a href="#using-join-with-the-books-database" id="toc-using-join-with-the-books-database" class="nav-link" data-scroll-target="#using-join-with-the-books-database"><span class="header-section-number">31.7</span> Using JOIN with the books database</a></li>
  <li><a href="#joining-three-or-more-tables" id="toc-joining-three-or-more-tables" class="nav-link" data-scroll-target="#joining-three-or-more-tables"><span class="header-section-number">31.8</span> Joining three or more tables</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql0014-theBooksDatabase-v001.html">Relational databases and SQL</a></li><li class="breadcrumb-item"><a href="./sql0035-workingWithMultipleTables-v012.html"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title"><yrchapternumber>31. </yrchapternumber> Inner Joins.</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title"><yrchapternumber>31. </yrchapternumber> Inner Joins.</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the packages that we'll need</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(sqldf)) { <span class="fu">install.packages</span>(<span class="st">"sqldf"</span>); <span class="fu">require</span>(sqldf) }</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(readr)) { <span class="fu">install.packages</span>(<span class="st">"readr"</span>); <span class="fu">require</span>(readr) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="importing-the-data-into-r" class="level2" data-number="31.1">
<h2 data-number="31.1" class="anchored" data-anchor-id="importing-the-data-into-r"><span class="header-section-number">31.1</span> Importing the data into R</h2>
<p>In section we will be referring to the “customers” and the “orders” tables as well as various tables from the “books database”. Instructions for downloading the necessary files and importing them into R are included in section above that describes how to “Get the data”.</p>
</section>
<section id="intro-to-joining-two-tables" class="level2" data-number="31.2">
<h2 data-number="31.2" class="anchored" data-anchor-id="intro-to-joining-two-tables"><span class="header-section-number">31.2</span> Intro to “JOIN”ing two tables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the data for the tables we'll be using</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>customers <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/customers.csv"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>orders <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/orders.csv"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="overview-of-the-customers-and-orders-tables" class="level3" data-number="31.2.1">
<h3 data-number="31.2.1" class="anchored" data-anchor-id="overview-of-the-customers-and-orders-tables"><span class="header-section-number">31.2.1</span> Overview of the customers and orders tables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The examples in this page use the customers and orders tables.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The data for those tables can be imported into R using the</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># customers.csv and the orders.csv files.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This code to read in the data from the csv files appears </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># further up in this file. </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># see this page for more info: https://www.w3schools.com/sql/sql_join.asp</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#........................................................................</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets see a few rows from the customers table and from the orders table</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#........................................................................</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select * from customers order by CustomerId limit 10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   CustomerID                       CustomerName        ContactName                       Address        City PostalCode Country
1           1                Alfreds Futterkiste       Maria Anders                 Obere Str. 57      Berlin      12209 Germany
2           2 Ana Trujillo Emparedados y helados       Ana Trujillo Avda. de la Constitución 2222 México D.F.      05021  Mexico
3           3            Antonio Moreno Taquería     Antonio Moreno                Mataderos 2312 México D.F.      05023  Mexico
4           4                    Around the Horn       Thomas Hardy               120 Hanover Sq.      London    WA1 1DP      UK
5           5                 Berglunds snabbköp Christina Berglund                Berguvsvägen 8       Luleå   S-958 22  Sweden
6           6            Blauer See Delikatessen         Hanna Moos                Forsterstr. 57    Mannheim      68306 Germany
7           7               Blondel père et fils Frédérique Citeaux              24, place Kléber  Strasbourg      67000  France
8           8          Bólido Comidas preparadas      Martín Sommer                C/ Araquil, 67      Madrid      28023   Spain
9           9                           Bon app'  Laurence Lebihans          12, rue des Bouchers   Marseille      13008  France
10         10             Bottom-Dollar Marketse  Elizabeth Lincoln            23 Tsawassen Blvd.   Tsawassen    T2F 8M4  Canada</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select * from orders order by CustomerId limit 10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   OrderID CustomerID EmployeeID  OrderDate ShipperID
1    10308          2          7  9/18/1996         3
2    10365          3          3 11/27/1996         2
3    10355          4          6 11/15/1996         1
4    10383          4          8 12/16/1996         3
5    10278          5          8  8/12/1996         2
6    10280          5          2  8/14/1996         1
7    10384          5          3 12/16/1996         3
8    10265          7          2  7/25/1996         1
9    10297          7          5   9/4/1996         2
10   10360          7          4 11/22/1996         3</code></pre>
</div>
</div>
</section>
</section>
<section id="primary-keys-and-foreign-keys" class="level2" data-number="31.3">
<h2 data-number="31.3" class="anchored" data-anchor-id="primary-keys-and-foreign-keys"><span class="header-section-number">31.3</span> “Primary Keys” and “Foreign Keys”</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Primary keys and Foreign keys</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Primary Key</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   Many relational database tables have a column that contains a unique value</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   for every row in the table. For example the customers table in the example</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   below contains a CustomerId column in the customers table. Each row in the </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   customers table contains a different value for the CustomerId. </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   This allows you to identify a specific customer (i.e a specific row in the table)</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   by the customer id. For example CustomerId 100 corresponds to one and only one</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   row in the customers table.</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   The CustomerId column in the Customers table is known as a "primary key". </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   Similarly, the orders table in the example below contains an OrderId</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   column. Each row in the orders table contains a unique value for the</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   OrderId. For example, orderId 10248 corresponds to exactly one row </span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   in the orders table. Therefore we say that the OrderId column is the </span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   "primary key" for the orders table.</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co"># - Foreign Key</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   Note that the orders table ALSO contains a CustomerId column.</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   The customerId in the orders table indicates which customer</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   placed a specific order. To find the name of the customer, the address</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   of the customer etc. you can look in the customers table for the row</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   that contains the specific customerId for the order.</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   Since a single customer can have many different orders,</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   the values of the CustomerId column in the orders table contains</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   repeats of the same CustomerId value (in different rows of the orders table). </span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   The customerId column in the orders table is NOT a primary key.</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   The customerId column in the orders table exists so that we</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   can look up the customer information for a particular order.</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   The CustomerId column in the orders table is known as a "foreign key".</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   In general a column in a table that contains information from</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   the primary key of a different table is known as a "foreign key".</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co"># In summary</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co"># - The CustomerId column in the customers table is a primary key</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="co"># - The OrderId column in the orders table is a primary key</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="co"># - The CustomerId column in the orders table is a foreign key</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="more-about-the-customers-and-orders-tables" class="level3" data-number="31.3.1">
<h3 data-number="31.3.1" class="anchored" data-anchor-id="more-about-the-customers-and-orders-tables"><span class="header-section-number">31.3.1</span> More about the customers and orders tables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the orders table arranged in the order of the customerID</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select *</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">       from orders</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">       order by CustomerID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    OrderID CustomerID EmployeeID  OrderDate ShipperID
1     10308          2          7  9/18/1996         3
2     10365          3          3 11/27/1996         2
3     10355          4          6 11/15/1996         1
4     10383          4          8 12/16/1996         3
5     10278          5          8  8/12/1996         2
6     10280          5          2  8/14/1996         1
7     10384          5          3 12/16/1996         3
8     10265          7          2  7/25/1996         1
9     10297          7          5   9/4/1996         2
10    10360          7          4 11/22/1996         3
11    10436          7          3   2/5/1997         2
12    10326          8          4 10/10/1996         2
13    10331          9          9 10/16/1996         1
14    10340          9          1 10/29/1996         3
15    10362          9          3 11/25/1996         1
16    10389         10          4 12/20/1996         2
17    10410         10          3  1/10/1997         3
18    10411         10          9  1/10/1997         3
19    10431         10          4  1/30/1997         2
20    10289         11          7  8/26/1996         3
21    10259         13          4  7/18/1996         3
22    10254         14          5  7/11/1996         2
23    10370         14          6  12/3/1996         2
24    10290         15          8  8/27/1996         1
25    10435         16          8   2/4/1997         2
26    10363         17          4 11/26/1996         3
27    10391         17          3 12/23/1996         3
28    10311         18          1  9/20/1996         3
29    10364         19          1 11/26/1996         1
30    10400         19          1   1/1/1997         3
31    10258         20          1  7/17/1996         1
32    10263         20          9  7/23/1996         3
33    10351         20          1 11/11/1996         1
34    10368         20          2 11/29/1996         2
35    10382         20          4 12/13/1996         1
36    10390         20          6 12/23/1996         1
37    10402         20          8   1/2/1997         2
38    10403         20          4   1/3/1997         3
39    10430         20          4  1/30/1997         1
40    10442         20          3  2/11/1997         2
41    10347         21          4  11/6/1996         3
42    10386         21          9 12/18/1996         3
43    10414         21          2  1/14/1997         3
44    10408         23          8   1/8/1997         1
45    10264         24          6  7/24/1996         3
46    10327         24          2 10/11/1996         1
47    10378         24          5 12/10/1996         3
48    10434         24          3   2/3/1997         2
49    10267         25          4  7/29/1996         1
50    10337         25          4 10/24/1996         3
51    10342         25          4 10/30/1996         2
52    10396         25          1 12/27/1996         3
53    10422         27          2  1/22/1997         1
54    10328         28          4 10/14/1996         3
55    10352         28          3 11/12/1996         3
56    10366         29          8 11/28/1996         2
57    10426         29          4  1/27/1997         1
58    10303         30          7  9/11/1996         2
59    10423         31          6  1/23/1997         3
60    10268         33          8  7/30/1996         3
61    10250         34          4   7/8/1996         2
62    10253         34          3  7/10/1996         2
63    10257         35          4  7/16/1996         3
64    10395         35          6 12/26/1996         1
65    10375         36          3  12/6/1996         2
66    10394         36          1 12/25/1996         3
67    10415         36          3  1/15/1997         1
68    10298         37          6   9/5/1996         2
69    10309         37          3  9/19/1996         1
70    10335         37          7 10/22/1996         2
71    10373         37          4  12/5/1996         3
72    10380         37          8 12/12/1996         3
73    10429         37          3  1/29/1997         2
74    10315         38          4  9/26/1996         2
75    10318         38          8  10/1/1996         2
76    10321         38          3  10/3/1996         2
77    10323         39          4  10/7/1996         1
78    10325         39          1  10/9/1996         3
79    10350         41          6 11/11/1996         2
80    10358         41          5 11/20/1996         1
81    10371         41          1  12/3/1996         1
82    10413         41          3  1/14/1997         2
83    10425         41          6  1/24/1997         2
84    10279         44          8  8/13/1996         2
85    10284         44          4  8/19/1996         1
86    10343         44          4 10/31/1996         1
87    10283         46          3  8/16/1996         3
88    10296         46          6   9/3/1996         1
89    10330         46          3 10/16/1996         1
90    10357         46          1 11/19/1996         3
91    10381         46          3 12/12/1996         3
92    10405         47          1   1/6/1997         1
93    10307         48          2  9/17/1996         2
94    10317         48          6  9/30/1996         1
95    10275         49          1   8/7/1996         1
96    10300         49          2   9/9/1996         2
97    10404         49          2   1/3/1997         1
98    10332         51          3 10/17/1996         2
99    10339         51          2 10/28/1996         2
100   10376         51          1  12/9/1996         2
101   10424         51          7  1/23/1997         2
102   10439         51          6   2/7/1997         3
103   10277         52          2   8/9/1996         3
104   10409         54          3   1/9/1997         1
105   10260         55          4  7/19/1996         1
106   10305         55          8  9/13/1996         3
107   10338         55          4 10/25/1996         3
108   10441         55          3  2/10/1997         2
109   10407         56          2   1/7/1997         2
110   10322         58          7  10/4/1996         3
111   10354         58          8 11/14/1996         3
112   10353         59          7 11/13/1996         3
113   10392         59          2 12/24/1996         3
114   10427         59          4  1/27/1997         2
115   10336         60          7 10/23/1996         2
116   10397         60          5 12/27/1996         1
117   10433         60          3   2/3/1997         3
118   10261         61          4  7/19/1996         2
119   10291         61          6  8/27/1996         2
120   10379         61          2 12/11/1996         1
121   10421         61          8  1/21/1997         1
122   10372         62          5  12/4/1996         2
123   10406         62          7   1/7/1997         1
124   10273         63          3   8/5/1996         3
125   10285         63          1  8/20/1996         2
126   10286         63          8  8/21/1996         3
127   10313         63          2  9/24/1996         2
128   10345         63          2  11/4/1996         2
129   10361         63          1 11/22/1996         2
130   10418         63          4  1/17/1997         1
131   10262         65          8  7/22/1996         3
132   10272         65          6   8/2/1996         2
133   10294         65          4  8/30/1996         2
134   10314         65          1  9/25/1996         2
135   10316         65          1  9/27/1996         3
136   10346         65          3  11/5/1996         3
137   10401         65          1   1/1/1997         1
138   10288         66          4  8/23/1996         1
139   10428         66          7  1/28/1997         1
140   10443         66          8  2/12/1997         1
141   10287         67          8  8/22/1996         3
142   10299         67          4   9/6/1996         2
143   10255         68          9  7/12/1996         3
144   10419         68          4  1/20/1997         2
145   10281         69          4  8/14/1996         1
146   10282         69          4  8/15/1996         1
147   10306         69          1  9/16/1996         3
148   10387         70          1 12/18/1996         2
149   10324         71          9  10/8/1996         1
150   10393         71          1 12/25/1996         3
151   10398         71          2 12/30/1996         3
152   10440         71          4  2/10/1997         2
153   10359         72          5 11/21/1996         3
154   10377         72          1  12/9/1996         3
155   10388         72          2 12/19/1996         1
156   10341         73          7 10/29/1996         3
157   10417         73          4  1/16/1997         3
158   10271         75          6   8/1/1996         2
159   10329         75          4 10/15/1996         2
160   10349         75          7  11/8/1996         1
161   10369         75          8  12/2/1996         2
162   10385         75          1 12/17/1996         2
163   10432         75          3  1/31/1997         2
164   10252         76          4   7/9/1996         2
165   10302         76          4  9/10/1996         2
166   10310         77          8  9/20/1996         2
167   10438         79          3   2/6/1997         2
168   10276         80          8   8/8/1996         3
169   10293         80          1  8/29/1996         3
170   10304         80          1  9/12/1996         2
171   10319         80          7  10/2/1996         3
172   10249         81          6   7/5/1996         1
173   10292         81          1  8/28/1996         2
174   10367         83          7 11/28/1996         3
175   10399         83          8 12/31/1996         3
176   10251         84          3   7/8/1996         1
177   10334         84          8 10/21/1996         2
178   10274         85          6   8/6/1996         1
179   10295         85          2   9/2/1996         2
180   10301         86          8   9/9/1996         2
181   10312         86          2  9/23/1996         2
182   10348         86          4  11/7/1996         2
183   10356         86          6 11/18/1996         2
184   10266         87          3  7/26/1996         3
185   10270         87          1   8/1/1996         1
186   10320         87          5  10/3/1996         3
187   10333         87          5 10/18/1996         3
188   10412         87          8  1/13/1997         2
189   10416         87          8  1/16/1997         3
190   10437         87          8   2/5/1997         1
191   10256         88          3  7/15/1996         2
192   10420         88          3  1/21/1997         1
193   10269         89          5  7/31/1996         1
194   10344         89          4  11/1/1996         2
195   10248         90          5   7/4/1996         3
196   10374         91          1  12/5/1996         3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show customer info for customer id 10</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select * from customers where CustomerId = 10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  CustomerID           CustomerName       ContactName            Address      City PostalCode Country
1         10 Bottom-Dollar Marketse Elizabeth Lincoln 23 Tsawassen Blvd. Tsawassen    T2F 8M4  Canada</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show all orders for customer id 10</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select * from orders where CustomerId = 10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  OrderID CustomerID EmployeeID  OrderDate ShipperID
1   10389         10          4 12/20/1996         2
2   10410         10          3  1/10/1997         3
3   10411         10          9  1/10/1997         3
4   10431         10          4  1/30/1997         2</code></pre>
</div>
</div>
</section>
<section id="joining-customers-and-orders-into-a-single-output" class="level3" data-number="31.3.2">
<h3 data-number="31.3.2" class="anchored" data-anchor-id="joining-customers-and-orders-into-a-single-output"><span class="header-section-number">31.3.2</span> JOINing customers and orders into a single output</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using the JOIN to combine information from two tables into a single output</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine information from the customers and the orders table.</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifically, show the following data</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - customer name and country from the customers table</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># - orderId, OrderDate from the orders table</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Only show data for all orders placed by customer 10</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select OrderID, customers.CustomerId, CustomerName, Country, OrderDate</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="st">       from orders join customers on orders.customerId = customers.CustomerId</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="st">       where customers.CustomerId = 10"</span>)   <span class="co"># ame result if you say orders.customerId</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  OrderID CustomerID           CustomerName Country  OrderDate
1   10389         10 Bottom-Dollar Marketse  Canada 12/20/1996
2   10410         10 Bottom-Dollar Marketse  Canada  1/10/1997
3   10411         10 Bottom-Dollar Marketse  Canada  1/10/1997
4   10431         10 Bottom-Dollar Marketse  Canada  1/30/1997</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do the same for customerids 1 through 5</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sql<span class="ot">=</span><span class="st">"select OrderID, customers.CustomerId, CustomerName, OrderDate</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="st">     from orders join customers on orders.customerId = customers.CustomerId</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="st">     where customers.CustomerId &gt;= 1 and customers.CustomerId &lt;= 5"</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  OrderID CustomerID                       CustomerName  OrderDate
1   10308          2 Ana Trujillo Emparedados y helados  9/18/1996
2   10365          3            Antonio Moreno Taquería 11/27/1996
3   10355          4                    Around the Horn 11/15/1996
4   10383          4                    Around the Horn 12/16/1996
5   10278          5                 Berglunds snabbköp  8/12/1996
6   10280          5                 Berglunds snabbköp  8/14/1996
7   10384          5                 Berglunds snabbköp 12/16/1996</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># another way, with the IN operator</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>sql<span class="ot">=</span><span class="st">"select OrderID, customers.CustomerId, CustomerName, OrderDate</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="st">     from orders join customers on orders.customerId = customers.CustomerId</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="st">     where customers.CustomerId IN (1,2,3,4,5)"</span>   <span class="co"># you would get the same result if you said orders.customerId</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  OrderID CustomerID                       CustomerName  OrderDate
1   10308          2 Ana Trujillo Emparedados y helados  9/18/1996
2   10365          3            Antonio Moreno Taquería 11/27/1996
3   10355          4                    Around the Horn 11/15/1996
4   10383          4                    Around the Horn 12/16/1996
5   10278          5                 Berglunds snabbköp  8/12/1996
6   10280          5                 Berglunds snabbköp  8/14/1996
7   10384          5                 Berglunds snabbköp 12/16/1996</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the orders that were shipped by shipper #3 for customers who</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># are from Mexico. Sort the results by the orderId</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>sql<span class="ot">=</span><span class="st">"select orderId, customerName, customers.customerId, shipperId, country</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="st">     from orders join customers on orders.customerId = customers.customerId</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="st">     where shipperId = 3 and country = 'Mexico'</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="st">     order by orderId"</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  OrderID                       CustomerName CustomerID ShipperID Country
1   10259         Centro comercial Moctezuma         13         3  Mexico
2   10276                Tortuga Restaurante         80         3  Mexico
3   10293                Tortuga Restaurante         80         3  Mexico
4   10308 Ana Trujillo Emparedados y helados          2         3  Mexico
5   10319                Tortuga Restaurante         80         3  Mexico
6   10322          Pericles Comidas clásicas         58         3  Mexico
7   10354          Pericles Comidas clásicas         58         3  Mexico</code></pre>
</div>
</div>
</section>
</section>
<section id="one-to-many-relationships" class="level2" data-number="31.4">
<h2 data-number="31.4" class="anchored" data-anchor-id="one-to-many-relationships"><span class="header-section-number">31.4</span> One to Many relationships</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################################################</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># One to Many relationships</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># EXAMPLE:</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#           a single SPECIFIC customer may have many orders</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#           a single SPECIFIC order is related to exactly one customer </span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># IN GENERAL:</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># A single SPECIFIC row in table A may be related to many (or possibly zero)</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># rows from table B. </span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># However a single SPECIFIC row from table B is related to </span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># EXACTLY ONE row from table A</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll call table A the "one table" and </span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co">#            table B the "many table"</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># - The "one" table has a primary key.</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co"># - The "many" table has a foreign key that contains values of the</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   other table's primary key values.</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="many-to-many-relationships" class="level2" data-number="31.5">
<h2 data-number="31.5" class="anchored" data-anchor-id="many-to-many-relationships"><span class="header-section-number">31.5</span> Many to Many relationships</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################################################</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Many to Many relationships</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># EXAMPLE:</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#           a single SPECIFIC author may have written many titles</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#           a single SPECIFIC book   may have many authors</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Many to many relationships cannot be directly expressed in relational</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># databases. </span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To establish a many to many relationship, a "middle" table is created</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># that contains the to foreign keys. Each of the foreign keys relate </span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co"># back to the primary key of one of the two tables. </span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># In the books database, the middle table is called title_authors.</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="practice---one-to-many-or-many-to-many" class="level2" data-number="31.6">
<h2 data-number="31.6" class="anchored" data-anchor-id="practice---one-to-many-or-many-to-many"><span class="header-section-number">31.6</span> Practice - “one to many” or “many to many”?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">###################################</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Practice identifying relationships</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - one to many</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - many to many</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="do">###################################</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION </span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># A university uses to tables to track their real estate.</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># The BUILDINGS table contains one row for each building they own.</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># The ROOMS table contains one row for each room in each building.</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Are the BUILDINGS and ROOMS tables in a "1 to many" or a </span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># "many to many" relationship?</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Given the following definitions of a BUILDINGS table and </span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># a ROOMS table draw a "crows foot" Entity Relationship Diagram.</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure to show the symbols for the maximum and minimum </span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co"># cardinalities. Explain in English what each symbol on your</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># diagram means. </span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------ </span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="co">#    BUILDINGS TABLE</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co">#    bldgCode    (PK)</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="co">#    streetAddress</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="co">#    city</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="co">#    state</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="co">#    zip</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="co">#    numOfFloors</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="co">#    ROOMS TABLE</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="co">#    bldgCode (PK)</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="co">#    roomNum  (PK)</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="co">#    capacity</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="co">#    type    (classroom, dorm room, office)</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="co">#    hasVideoProjection (TRUE/FALSE)</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="co"># The same university keeps track of their professors, the courses </span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="co"># that are in the course catalog and the specific offerings every</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="co"># semester. Think about how these concepts are related to each other.</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a><span class="co"># How are PROFESSORS related to COURSES? "one to many", "many to one", "many to many"?</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a><span class="co"># How are PROFESSORS related to OFFERINGS? "one to many", "many to one", "many to many"?</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="co"># How are COURSES related to OFFERINGS? "one to many", "many to one", "many to many"?</span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="co"># The following tables could be used to track this info.</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the crows foot Entity Relationship Diagram.</span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure to show the symbols for the maximum and minimum </span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a><span class="co"># cardinalities. Explain in English what each symbol on your</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a><span class="co"># diagram means. </span></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------</span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a><span class="co"># PROFESSORS TABLE</span></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Description: this table contains exactly one row for each professor that is</span></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a><span class="co"># employed by the university. </span></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a><span class="co"># facultyId (PK)</span></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a><span class="co"># firstName</span></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a><span class="co"># lastName</span></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a><span class="co"># department</span></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a><span class="co"># salary</span></span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a><span class="co"># yearHired</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a><span class="co"># OFFERINGS TABLE</span></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Description: this table contains info about the sections that are </span></span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a><span class="co"># being offered in particular semesters.</span></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a><span class="co"># crn (PK)</span></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a><span class="co"># courseNumber (FK1)</span></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a><span class="co"># semester</span></span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a><span class="co"># year</span></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a><span class="co"># room</span></span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a><span class="co"># buildingId</span></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a><span class="co"># facutyId (FK2)</span></span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a><span class="co"># COURSES TABLE </span></span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Description: This table contains one row for each course in the course catalog.</span></span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that not every course is offered every semester. Some courses have</span></span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple offerings in a single semester.</span></span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a><span class="co"># courseNumber (PK)</span></span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a><span class="co"># courseName</span></span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a><span class="co"># credits</span></span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a><span class="co"># description</span></span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="using-join-with-the-books-database" class="level2 page-columns page-full" data-number="31.7">
<h2 data-number="31.7" class="anchored" data-anchor-id="using-join-with-the-books-database"><span class="header-section-number">31.7</span> Using JOIN with the books database</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The books database contains information about various books, authors,</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># publishers, etc.</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the data for the books database - see the </span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>titles <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/booksDatabase/titles.csv"</span>, <span class="at">na=</span><span class="st">"NULL"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>authors <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/booksDatabase/authors.csv"</span>, <span class="at">na=</span><span class="st">"NULL"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>publishers <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/booksDatabase/publishers.csv"</span>, <span class="at">na=</span><span class="st">"NULL"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>title_authors <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/booksDatabase/title_authors.csv"</span>, <span class="at">na=</span><span class="st">"NULL"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>royalties <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/booksDatabase/royalties.csv"</span>, <span class="at">na=</span><span class="st">"NULL"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION: Write a SQL select statement (i.e. a "query") to display the following data.</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># For each title, show the </span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># - title name</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co"># - num pages</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co"># - publisher name</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># - publisher country</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ANSWER</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select title_name, pages, pub_name, country</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="st">       from publishers  join   titles  on  publishers.pub_id = titles.pub_id"</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name pages             pub_name country
1                                1977!   107    Abatis Publishers     USA
2            But I Did It Unconciously   510    Abatis Publishers     USA
3               Exchange of Platitudes   201    Abatis Publishers     USA
4                     How About Never?   473    Abatis Publishers     USA
5         Just Wait Until After School    86    Abatis Publishers     USA
6                      Kiss My Boo Boo    22    Abatis Publishers     USA
7         Ask Yor System Administrator  1226      Core Dump Books     USA
8            200 Years of German Humor    14 Schandenfreude Press Germany
9                    I Blame My Mother   333 Schandenfreude Press Germany
10 What Are The Civilian Applications?   802 Schandenfreude Press Germany
11         Not Without My Fabrerge Egg    NA       AAA Publishing     USA
12    Perhaps It's a Glandular Problem   826       AAA Publishing     USA
13           Spontaneous, Not Annoying   507       AAA Publishing     USA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To be more clear where each column comes from you can</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write the columns in the format tableName.columnName.</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (In this example it's not necessary to do so - but can make your code easier</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># to understand. Later we'll see examples where you must specify the </span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># tablename.colname format).</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select titles.title_name, titles.pages, publishers.pub_name, publishers.country</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="st">       from publishers  join   titles  on  publishers.pub_id = titles.pub_id"</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name pages             pub_name country
1                                1977!   107    Abatis Publishers     USA
2            But I Did It Unconciously   510    Abatis Publishers     USA
3               Exchange of Platitudes   201    Abatis Publishers     USA
4                     How About Never?   473    Abatis Publishers     USA
5         Just Wait Until After School    86    Abatis Publishers     USA
6                      Kiss My Boo Boo    22    Abatis Publishers     USA
7         Ask Yor System Administrator  1226      Core Dump Books     USA
8            200 Years of German Humor    14 Schandenfreude Press Germany
9                    I Blame My Mother   333 Schandenfreude Press Germany
10 What Are The Civilian Applications?   802 Schandenfreude Press Germany
11         Not Without My Fabrerge Egg    NA       AAA Publishing     USA
12    Perhaps It's a Glandular Problem   826       AAA Publishing     USA
13           Spontaneous, Not Annoying   507       AAA Publishing     USA</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
See next section about “CROSS JOINS”
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before going further, please take a few minutes and read the information on “CROSS JOIN” that is found in the next section of this website. The discussion of CROSS JOINS will be moved to this location soon…</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DEEPER EXPLANATION</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We learned earlier about a "CROSS JOIN" that takes the rows of two different</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tables and combines them in every way. This is useful when you want to see</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># every possible combination of the rows of two different tables. For example,</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># if you have a table of shirts and a table of pants and you want to see every</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># possible combination of a shirt with a pair of pants, a cross join might</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># be appropriate. However, most of the time that is not what you want to do.</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Most of the time, the appropropriate type of join is known a an "INNER JOIN"</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># (or just simply "JOIN", the word inner is optional).</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># An inner join matches up those rows from two</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># different tables that share a primary key and a foreign key with the same</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># values.</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># However, a cross join is actually at the heart of how the database </span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># performs an inner join internally. Specifically whenever the SQL code</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co"># specifies an inner join (i.e. "join") the database first performs a</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co"># cross join and then removes the rows from the cross join </span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co"># results that do not match the ON clause of the INNER JOIN.</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's look at that in a little more detail ...</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="co"># First thing that happens when the above query is processed internally</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="co"># is the following cross join</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell column-screen-inset-right">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select titles.*, publishers.*</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles cross join publishers"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name       type pub_id pages price   sales         pubdate pub_id             pub_name          city state country
1       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00    P01    Abatis Publishers      New York    NY     USA
2       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00    P02      Core Dump Books San Francisco    CA     USA
3       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
4       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
5       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
6       T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00    P01    Abatis Publishers      New York    NY     USA
7       T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00    P02      Core Dump Books San Francisco    CA     USA
8       T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
9       T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
10      T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00    P05       AAA Publishing      Berkeley    CA     USA
11      T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00    P01    Abatis Publishers      New York    NY     USA
12      T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00    P02      Core Dump Books San Francisco    CA     USA
13      T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
14      T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
15      T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
16      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00    P01    Abatis Publishers      New York    NY     USA
17      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00    P02      Core Dump Books San Francisco    CA     USA
18      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
19      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
20      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00    P05       AAA Publishing      Berkeley    CA     USA
21      T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00    P01    Abatis Publishers      New York    NY     USA
22      T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00    P02      Core Dump Books San Francisco    CA     USA
23      T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
24      T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
25      T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00    P05       AAA Publishing      Berkeley    CA     USA
26      T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00    P01    Abatis Publishers      New York    NY     USA
27      T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00    P02      Core Dump Books San Francisco    CA     USA
28      T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
29      T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
30      T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
31      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00    P01    Abatis Publishers      New York    NY     USA
32      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00    P02      Core Dump Books San Francisco    CA     USA
33      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
34      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
35      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00    P05       AAA Publishing      Berkeley    CA     USA
36      T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00    P01    Abatis Publishers      New York    NY     USA
37      T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00    P02      Core Dump Books San Francisco    CA     USA
38      T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
39      T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
40      T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00    P05       AAA Publishing      Berkeley    CA     USA
41      T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00    P01    Abatis Publishers      New York    NY     USA
42      T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00    P02      Core Dump Books San Francisco    CA     USA
43      T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
44      T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
45      T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00    P05       AAA Publishing      Berkeley    CA     USA
46      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;    P01    Abatis Publishers      New York    NY     USA
47      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;    P02      Core Dump Books San Francisco    CA     USA
48      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
49      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;    P04    Tneterhooks Press      Berkeley    CA     USA
50      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;    P05       AAA Publishing      Berkeley    CA     USA
51      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P01    Abatis Publishers      New York    NY     USA
52      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P02      Core Dump Books San Francisco    CA     USA
53      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
54      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
55      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
56      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00    P01    Abatis Publishers      New York    NY     USA
57      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00    P02      Core Dump Books San Francisco    CA     USA
58      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
59      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
60      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
61      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00    P01    Abatis Publishers      New York    NY     USA
62      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00    P02      Core Dump Books San Francisco    CA     USA
63      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
64      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00    P04    Tneterhooks Press      Berkeley    CA     USA
65      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00    P05       AAA Publishing      Berkeley    CA     USA</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># after that , the rows that don't match the "on" clause in the inner join</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># are removed from the results. This can be seen by adding a where clause </span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># to the cross join shown above.</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select titles.*, publishers.*</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles cross join publishers</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="st">       where titles.pub_id = publishers.pub_id"</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name       type pub_id pages price   sales         pubdate pub_id             pub_name          city state country
1       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00    P01    Abatis Publishers      New York    NY     USA
2       T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
3       T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00    P02      Core Dump Books San Francisco    CA     USA
4       T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00    P01    Abatis Publishers      New York    NY     USA
5       T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00    P01    Abatis Publishers      New York    NY     USA
6       T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00    P01    Abatis Publishers      New York    NY     USA
7       T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
8       T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00    P01    Abatis Publishers      New York    NY     USA
9       T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00    P01    Abatis Publishers      New York    NY     USA
10      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;    P05       AAA Publishing      Berkeley    CA     USA
11      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
12      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
13      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The last thing that happens is that just the columns that appear in </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the select clause are displayed. Therefore, the following two </span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># queries are equivalent</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the inner join version (we copied this from above)</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select title_name, pages, pub_name, country</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="st">       from publishers  join   titles  on  publishers.pub_id = titles.pub_id"</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name pages             pub_name country
1                                1977!   107    Abatis Publishers     USA
2            But I Did It Unconciously   510    Abatis Publishers     USA
3               Exchange of Platitudes   201    Abatis Publishers     USA
4                     How About Never?   473    Abatis Publishers     USA
5         Just Wait Until After School    86    Abatis Publishers     USA
6                      Kiss My Boo Boo    22    Abatis Publishers     USA
7         Ask Yor System Administrator  1226      Core Dump Books     USA
8            200 Years of German Humor    14 Schandenfreude Press Germany
9                    I Blame My Mother   333 Schandenfreude Press Germany
10 What Are The Civilian Applications?   802 Schandenfreude Press Germany
11         Not Without My Fabrerge Egg    NA       AAA Publishing     USA
12    Perhaps It's a Glandular Problem   826       AAA Publishing     USA
13           Spontaneous, Not Annoying   507       AAA Publishing     USA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Version with a cross join - this is what happens internally when</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># you write an inner join (i.e. "join")</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select title_name, pages, pub_name, country</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles cross join publishers</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="st">       where titles.pub_id = publishers.pub_id"</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name pages             pub_name country
1                                1977!   107    Abatis Publishers     USA
2            200 Years of German Humor    14 Schandenfreude Press Germany
3         Ask Yor System Administrator  1226      Core Dump Books     USA
4            But I Did It Unconciously   510    Abatis Publishers     USA
5               Exchange of Platitudes   201    Abatis Publishers     USA
6                     How About Never?   473    Abatis Publishers     USA
7                    I Blame My Mother   333 Schandenfreude Press Germany
8         Just Wait Until After School    86    Abatis Publishers     USA
9                      Kiss My Boo Boo    22    Abatis Publishers     USA
10         Not Without My Fabrerge Egg    NA       AAA Publishing     USA
11    Perhaps It's a Glandular Problem   826       AAA Publishing     USA
12           Spontaneous, Not Annoying   507       AAA Publishing     USA
13 What Are The Civilian Applications?   802 Schandenfreude Press Germany</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Only show results for books that have at least 100 pages</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select title_name, pages, pub_name, country</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="st">       from publishers  join   titles  on  publishers.pub_id = titles.pub_id</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="st">       where pages &gt;= 100"</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           title_name pages             pub_name country
1                               1977!   107    Abatis Publishers     USA
2        Ask Yor System Administrator  1226      Core Dump Books     USA
3           But I Did It Unconciously   510    Abatis Publishers     USA
4              Exchange of Platitudes   201    Abatis Publishers     USA
5                    How About Never?   473    Abatis Publishers     USA
6                   I Blame My Mother   333 Schandenfreude Press Germany
7    Perhaps It's a Glandular Problem   826       AAA Publishing     USA
8           Spontaneous, Not Annoying   507       AAA Publishing     USA
9 What Are The Civilian Applications?   802 Schandenfreude Press Germany</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Only show books that are at least 100 pages and published in the USA</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select title_name, pages, pub_name, country</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="st">       from publishers  join   titles  on  publishers.pub_id = titles.pub_id</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="st">       where pages &gt;= 100 and country = 'USA'"</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        title_name pages          pub_name country
1                            1977!   107 Abatis Publishers     USA
2        But I Did It Unconciously   510 Abatis Publishers     USA
3           Exchange of Platitudes   201 Abatis Publishers     USA
4                 How About Never?   473 Abatis Publishers     USA
5     Ask Yor System Administrator  1226   Core Dump Books     USA
6 Perhaps It's a Glandular Problem   826    AAA Publishing     USA
7        Spontaneous, Not Annoying   507    AAA Publishing     USA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Show books that are shorter than 100 pages  and books that are at least 1000 pages</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Do not show any other books.</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Only show books from the USA.</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select title_name, pages, pub_name, country</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="st">       from publishers  join   titles  on  publishers.pub_id = titles.pub_id</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="st">       where (pages &lt; 100 or pages &gt;= 1000) and country = 'USA' "</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    title_name pages          pub_name country
1 Just Wait Until After School    86 Abatis Publishers     USA
2              Kiss My Boo Boo    22 Abatis Publishers     USA
3 Ask Yor System Administrator  1226   Core Dump Books     USA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># show the results in the order of the length of the book (i.e. # of pages)</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># show the shortest books at the top</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select title_name, pages, pub_name, country</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="st">       from publishers  join   titles  on  publishers.pub_id = titles.pub_id</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="st">       where (pages &lt; 100 or pages &gt;= 1000) and country = 'USA' </span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="st">       order by pages asc"</span>     <span class="co"># asc is optional - you don't have to write it - it is the default</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    title_name pages          pub_name country
1              Kiss My Boo Boo    22 Abatis Publishers     USA
2 Just Wait Until After School    86 Abatis Publishers     USA
3 Ask Yor System Administrator  1226   Core Dump Books     USA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># do the same thing but put the largest books at the top</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select title_name, pages, pub_name, country</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="st">       from publishers  join   titles  on  publishers.pub_id = titles.pub_id</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="st">       where (pages &lt; 100 or pages &gt;= 1000) and country = 'USA' </span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="st">       order by pages desc"</span>     <span class="co"># you must write desc (i.e. descending)</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    title_name pages          pub_name country
1 Ask Yor System Administrator  1226   Core Dump Books     USA
2 Just Wait Until After School    86 Abatis Publishers     USA
3              Kiss My Boo Boo    22 Abatis Publishers     USA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION - add the pub_id to the output of the previous query.</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ANSWER</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Because the pub_id exists in both the publishers and the titles</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># tables, every time that pub_id is used in the query, you must also include</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the name of the table.</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># For more info, see the comment below entitled</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     # select table.column ...        vs       select column ... </span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select publishers.pub_id, title_name, pages, pub_name, country</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="st">       from publishers  join   titles  on  publishers.pub_id = titles.pub_id</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="st">       where (pages &lt; 100 or pages &gt;= 1000) and country = 'USA' </span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="st">       order by pages desc"</span>     </span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pub_id                   title_name pages          pub_name country
1    P02 Ask Yor System Administrator  1226   Core Dump Books     USA
2    P01 Just Wait Until After School    86 Abatis Publishers     USA
3    P01              Kiss My Boo Boo    22 Abatis Publishers     USA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># it will also work if you write titles.pub_id because once the table have been</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># joined together, the row from the publishers table and the corresponding</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># row from the titles table both have the same value for the pub_id</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For more info, see the comment below entitled</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     # select table.column ...        vs       select column ... </span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select titles.pub_id, title_name, pages, pub_name, country</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="st">       from publishers  join   titles  on  publishers.pub_id = titles.pub_id</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="st">       where (pages &lt; 100 or pages &gt;= 1000) and country = 'USA' </span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="st">       order by pages desc"</span>     </span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pub_id                   title_name pages          pub_name country
1    P02 Ask Yor System Administrator  1226   Core Dump Books     USA
2    P01 Just Wait Until After School    86 Abatis Publishers     USA
3    P01              Kiss My Boo Boo    22 Abatis Publishers     USA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You could include the table names even for columns that don't rquire it.</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select titles.pub_id, titles.title_name, titles.pages, publishers.pub_name, publishers.country</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="st">       from publishers  join   titles  on  publishers.pub_id = titles.pub_id</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="st">       where (pages &lt; 100 or pages &gt;= 1000) and country = 'USA' </span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="st">       order by pages desc"</span>     </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pub_id                   title_name pages          pub_name country
1    P02 Ask Yor System Administrator  1226   Core Dump Books     USA
2    P01 Just Wait Until After School    86 Abatis Publishers     USA
3    P01              Kiss My Boo Boo    22 Abatis Publishers     USA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># select table.column ...        vs       select column ... </span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># You must include table names in the SELECT clause for columns that </span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># appear in more than one table. Column names that that only appear </span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># in a single table in the query do NOT need to be preceded by the table name. </span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># However, it is PERMISSIBLE to include the table name for ANY column (even</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># if the column only appears in a single table).</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Some people prefer to include the table name even when it </span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># is not necessary (as done above) to make it clearer to someone reading the </span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># code which table contains which columns.</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the title_id, the title, and the author ID</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="co"># for each author that had a part in writing a book. </span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="co"># If there is more than one author for a title then show a different row</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="co"># in the output for each author.</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the rows in alphabetical order by title.</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="co"># ANSWER</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select titles.title_id, title_name, au_id</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles join title_authors   on    titles.title_id = title_authors.title_id</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="st">       order by title_name"</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name au_id
1       T01                               1977!   A01
2       T02           200 Years of German Humor   A01
3       T03        Ask Yor System Administrator   A05
4       T04           But I Did It Unconciously   A03
5       T04           But I Did It Unconciously   A04
6       T05              Exchange of Platitudes   A04
7       T06                    How About Never?   A02
8       T07                   I Blame My Mother   A02
9       T07                   I Blame My Mother   A04
10      T08        Just Wait Until After School   A06
11      T09                     Kiss My Boo Boo   A06
12      T10         Not Without My Fabrerge Egg   A02
13      T11    Perhaps It's a Glandular Problem   A03
14      T11    Perhaps It's a Glandular Problem   A04
15      T11    Perhaps It's a Glandular Problem   A06
16      T12           Spontaneous, Not Annoying   A02
17      T13 What Are The Civilian Applications?   A01</code></pre>
</div>
</div>
</section>
<section id="joining-three-or-more-tables" class="level2" data-number="31.8">
<h2 data-number="31.8" class="anchored" data-anchor-id="joining-three-or-more-tables"><span class="header-section-number">31.8</span> Joining three or more tables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Joining three or more tables</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For many queries you will need to join more than two tables together.</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For example, suppose we wanted to list the titles and the author names</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for each title.</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The title_name column is in the titles table. </span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># The au_fname and au_lname columns are in the authors tables.</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Therefore, you will obviously need to include the titles and authors</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co"># tables in the select statement. However, the only way to figure</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co"># out which authors wrote which titles is to </span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co"># also look at the title_authors table. Therefore the title_authors</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co"># table must also be part of the query.</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co"># The best way to understand which tables must be included in a query</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co"># is to look at the ERD (Entity Relationship Diagram) for the database.</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="co"># If you need data from two different tables that are not directly </span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="co"># connected to each other on the diagram, you will also need to join all of the</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="co"># tables that lie BETWEEN those tables also.</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="co"># To join multiple tables together, look at the diagram and find "path" on the</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="co"># diagram starting with one table that you need data from and ending with </span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="co"># another table that you need data from. </span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a><span class="co"># For example, if you want to show</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a><span class="co"># the author names and the title names, you can start with the authors</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="co"># table, then join onto that the title_authors table, then finally join </span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="co"># the authors table.</span></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively, you could start with the titles table, then join onto</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a><span class="co"># that the title_authors table and then finally join the authors table.</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="co"># It doesn't make a difference which table you start with and which table you</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a><span class="co"># end with, as long as you join all of the tables in the path of tables.</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the the same info as the previous query but instead of the au_id,</span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a><span class="co"># show the authors first and last names.</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select titles.title_id, title_name, authors.au_id, au_fname, au_lname</span></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles join title_authors   on    titles.title_id = title_authors.title_id</span></span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a><span class="st">                   join authors         on    authors.au_id   = title_authors.au_id</span></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a><span class="st">       order by titles.title_id"</span></span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name au_id  au_fname  au_lname
1       T01                               1977!   A01     Sarah   Buchman
2       T02           200 Years of German Humor   A01     Sarah   Buchman
3       T03        Ask Yor System Administrator   A05 Christian     Kells
4       T04           But I Did It Unconciously   A03    Hallie      Hull
5       T04           But I Did It Unconciously   A04      Klee      Hull
6       T05              Exchange of Platitudes   A04      Klee      Hull
7       T06                    How About Never?   A02     Wendy Heydemark
8       T07                   I Blame My Mother   A02     Wendy Heydemark
9       T07                   I Blame My Mother   A04      Klee      Hull
10      T08        Just Wait Until After School   A06    Harvey   Kellsey
11      T09                     Kiss My Boo Boo   A06    Harvey   Kellsey
12      T10         Not Without My Fabrerge Egg   A02     Wendy Heydemark
13      T11    Perhaps It's a Glandular Problem   A03    Hallie      Hull
14      T11    Perhaps It's a Glandular Problem   A04      Klee      Hull
15      T11    Perhaps It's a Glandular Problem   A06    Harvey   Kellsey
16      T12           Spontaneous, Not Annoying   A02     Wendy Heydemark
17      T13 What Are The Civilian Applications?   A01     Sarah   Buchman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Same as previous question but show the au_id in addition to the authors' names.</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ANSWER</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The only extra issue in this question is that since the au_id column </span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># appears in more than one table in the query (i.e. it's in titles</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and in the title_authors tables), You cannot simply type au_id in </span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the select clause - that would be an ambiguous column name. </span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Rather you must write either authors.au_id or title_authors.au_id.</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Either one authors.au_id or title_authors.au_id will yield the exact</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co"># same results because after the "on" clauses got finished processing</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co"># the only rows left from the cross join are rows in which the</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="co"># authors.au_id and title_authors.au_id columns contain the same values.</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="co"># or title_authors.au_id. You </span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="co"># WRONG ... the au_id column is ambiguous - you need to specify the table name</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select titles.title_id, title_name, au_id, au_fname, au_lname</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles join title_authors   on    titles.title_id = title_authors.title_id</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="st">                   join authors         on    authors.au_id   = title_authors.au_id</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="st">       order by titles.title_id"</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error: ambiguous column name: au_id</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This works (authors.au_id)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select titles.title_id, title_name, authors.au_id, au_fname, au_lname</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles join title_authors   on    titles.title_id = title_authors.title_id</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="st">                   join authors         on    authors.au_id   = title_authors.au_id</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="st">       order by titles.title_id"</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name au_id  au_fname  au_lname
1       T01                               1977!   A01     Sarah   Buchman
2       T02           200 Years of German Humor   A01     Sarah   Buchman
3       T03        Ask Yor System Administrator   A05 Christian     Kells
4       T04           But I Did It Unconciously   A03    Hallie      Hull
5       T04           But I Did It Unconciously   A04      Klee      Hull
6       T05              Exchange of Platitudes   A04      Klee      Hull
7       T06                    How About Never?   A02     Wendy Heydemark
8       T07                   I Blame My Mother   A02     Wendy Heydemark
9       T07                   I Blame My Mother   A04      Klee      Hull
10      T08        Just Wait Until After School   A06    Harvey   Kellsey
11      T09                     Kiss My Boo Boo   A06    Harvey   Kellsey
12      T10         Not Without My Fabrerge Egg   A02     Wendy Heydemark
13      T11    Perhaps It's a Glandular Problem   A03    Hallie      Hull
14      T11    Perhaps It's a Glandular Problem   A04      Klee      Hull
15      T11    Perhaps It's a Glandular Problem   A06    Harvey   Kellsey
16      T12           Spontaneous, Not Annoying   A02     Wendy Heydemark
17      T13 What Are The Civilian Applications?   A01     Sarah   Buchman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This also works (title_authors.au_id)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select titles.title_id, title_name, title_authors.au_id, au_fname, au_lname</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles join title_authors   on    titles.title_id = title_authors.title_id</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="st">                   join authors         on    authors.au_id   = title_authors.au_id</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="st">       order by titles.title_id"</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name au_id  au_fname  au_lname
1       T01                               1977!   A01     Sarah   Buchman
2       T02           200 Years of German Humor   A01     Sarah   Buchman
3       T03        Ask Yor System Administrator   A05 Christian     Kells
4       T04           But I Did It Unconciously   A03    Hallie      Hull
5       T04           But I Did It Unconciously   A04      Klee      Hull
6       T05              Exchange of Platitudes   A04      Klee      Hull
7       T06                    How About Never?   A02     Wendy Heydemark
8       T07                   I Blame My Mother   A02     Wendy Heydemark
9       T07                   I Blame My Mother   A04      Klee      Hull
10      T08        Just Wait Until After School   A06    Harvey   Kellsey
11      T09                     Kiss My Boo Boo   A06    Harvey   Kellsey
12      T10         Not Without My Fabrerge Egg   A02     Wendy Heydemark
13      T11    Perhaps It's a Glandular Problem   A03    Hallie      Hull
14      T11    Perhaps It's a Glandular Problem   A04      Klee      Hull
15      T11    Perhaps It's a Glandular Problem   A06    Harvey   Kellsey
16      T12           Spontaneous, Not Annoying   A02     Wendy Heydemark
17      T13 What Are The Civilian Applications?   A01     Sarah   Buchman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 19.   List the publisher name, the title_name, the authors first and last names,</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     the author's state and the publishers state for all books.</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     Make sure that in the output the authors state and publishers state</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     columns are clearly labeled as such.</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     Sort the rows alphabetically by the title name. If a title has more than one </span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     author then there will be a different row in the output for each author.</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     Sort those rows alphabetically by the publisher name, then by the </span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     title and finally by the author's names.</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ANSWER</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="co"># This query requires joining 4 different tables.</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co"># See the code for details.</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that in the order by the au_lname comes before au_fname (this is in</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co"># general how people's names are sorted alphabetically)</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select pub_name, title_name, au_fname, au_lname,</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="st">              authors.state as 'author state', </span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="st">              publishers.state as 'publisher state'</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="st">    from authors join title_authors on authors.au_id = title_authors.au_id </span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="st">                          join titles on title_authors.title_id = titles.title_id </span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a><span class="st">                          join publishers on publishers.pub_id = titles.pub_id</span></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="st">  order by pub_name, title_name, au_lname, au_fname"</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               pub_name                          title_name  au_fname  au_lname author state publisher state
1        AAA Publishing         Not Without My Fabrerge Egg     Wendy Heydemark           CO              CA
2        AAA Publishing    Perhaps It's a Glandular Problem    Hallie      Hull           CA              CA
3        AAA Publishing    Perhaps It's a Glandular Problem      Klee      Hull           CA              CA
4        AAA Publishing    Perhaps It's a Glandular Problem    Harvey   Kellsey           CA              CA
5        AAA Publishing           Spontaneous, Not Annoying     Wendy Heydemark           CO              CA
6     Abatis Publishers                               1977!     Sarah   Buchman           NY              NY
7     Abatis Publishers           But I Did It Unconciously    Hallie      Hull           CA              NY
8     Abatis Publishers           But I Did It Unconciously      Klee      Hull           CA              NY
9     Abatis Publishers              Exchange of Platitudes      Klee      Hull           CA              NY
10    Abatis Publishers                    How About Never?     Wendy Heydemark           CO              NY
11    Abatis Publishers        Just Wait Until After School    Harvey   Kellsey           CA              NY
12    Abatis Publishers                     Kiss My Boo Boo    Harvey   Kellsey           CA              NY
13      Core Dump Books        Ask Yor System Administrator Christian     Kells           NY              CA
14 Schandenfreude Press           200 Years of German Humor     Sarah   Buchman           NY            &lt;NA&gt;
15 Schandenfreude Press                   I Blame My Mother     Wendy Heydemark           CO            &lt;NA&gt;
16 Schandenfreude Press                   I Blame My Mother      Klee      Hull           CA            &lt;NA&gt;
17 Schandenfreude Press What Are The Civilian Applications?     Sarah   Buchman           NY            &lt;NA&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following shows a breakdown of what is actually happening when you </span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># join multiple tables. All of the following "steps" happen at once when </span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># you run the single query shown above in the answer. This breakdown</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># of the steps helps you to understand what exactly is happening.</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># step 1 - the first two tables are joined </span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select authors.*, title_authors.*</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="st">    from authors join title_authors on authors.au_id = title_authors.au_id"</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_id  au_fname  au_lname        phone              address          city state   zip title_id au_id au_order royalty_shares
1    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T01   A01        1            1.0
2    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T02   A01        1            1.0
3    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T13   A01        1            1.0
4    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T06   A02        1            1.0
5    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T07   A02        1            0.5
6    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T10   A02        1            1.0
7    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T12   A02        1            1.0
8    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A03        1            0.6
9    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A03        2            0.3
10   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A04        2            0.4
11   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T05   A04        1            1.0
12   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A04        2            0.5
13   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A04        3            0.3
14   A05 Christian     Kells 212-771-4680       114 Horatio St      New York    NY 10014      T03   A05        1            1.0
15   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T08   A06        1            1.0
16   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T09   A06        1            1.0
17   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A06        1            0.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 2 - the results from the join of the</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co">#          1st two tables (authors and title_authors) is joined with</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co">#          the 3rd table (titles)</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select authors.*, title_authors.*, titles.*</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="st">    from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="st">                          join titles on title_authors.title_id = titles.title_id"</span> </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_id  au_fname  au_lname        phone              address          city state   zip title_id au_id au_order royalty_shares title_id                          title_name       type pub_id pages price   sales         pubdate
1    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T01   A01        1            1.0      T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00
2    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T02   A01        1            1.0      T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00
3    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T13   A01        1            1.0      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00
4    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T06   A02        1            1.0      T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00
5    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T07   A02        1            0.5      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00
6    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T10   A02        1            1.0      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;
7    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T12   A02        1            1.0      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00
8    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A03        1            0.6      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00
9    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A03        2            0.3      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00
10   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A04        2            0.4      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00
11   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T05   A04        1            1.0      T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00
12   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A04        2            0.5      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00
13   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A04        3            0.3      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00
14   A05 Christian     Kells 212-771-4680       114 Horatio St      New York    NY 10014      T03   A05        1            1.0      T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00
15   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T08   A06        1            1.0      T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00
16   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T09   A06        1            1.0      T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00
17   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A06        1            0.4      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 3 - the results from the join of the first 3 tables (authors,</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">#          title_authors, titles) is then joined with the 4th table (publishers)</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select authors.*, title_authors.*, titles.*, publishers.*</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="st">    from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="st">                          join titles on title_authors.title_id = titles.title_id</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="st">                        join publishers on publishers.pub_id = titles.pub_id"</span> </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_id  au_fname  au_lname        phone              address          city state   zip title_id au_id au_order royalty_shares title_id                          title_name       type pub_id pages price   sales         pubdate pub_id             pub_name          city state country
1    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T01   A01        1            1.0      T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00    P01    Abatis Publishers      New York    NY     USA
2    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T02   A01        1            1.0      T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
3    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T13   A01        1            1.0      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
4    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T06   A02        1            1.0      T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00    P01    Abatis Publishers      New York    NY     USA
5    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T07   A02        1            0.5      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
6    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T10   A02        1            1.0      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;    P05       AAA Publishing      Berkeley    CA     USA
7    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T12   A02        1            1.0      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
8    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A03        1            0.6      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00    P01    Abatis Publishers      New York    NY     USA
9    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A03        2            0.3      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
10   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A04        2            0.4      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00    P01    Abatis Publishers      New York    NY     USA
11   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T05   A04        1            1.0      T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00    P01    Abatis Publishers      New York    NY     USA
12   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A04        2            0.5      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
13   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A04        3            0.3      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
14   A05 Christian     Kells 212-771-4680       114 Horatio St      New York    NY 10014      T03   A05        1            1.0      T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00    P02      Core Dump Books San Francisco    CA     USA
15   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T08   A06        1            1.0      T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00    P01    Abatis Publishers      New York    NY     USA
16   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T09   A06        1            1.0      T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00    P01    Abatis Publishers      New York    NY     USA
17   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A06        1            0.4      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 4 - the order by clause puts the rows in the correct order</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select authors.*, title_authors.*, titles.*, publishers.*</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="st">    from authors join title_authors on authors.au_id = title_authors.au_id </span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="st">                          join titles on title_authors.title_id = titles.title_id </span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="st">                          join publishers on publishers.pub_id = titles.pub_id"</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_id  au_fname  au_lname        phone              address          city state   zip title_id au_id au_order royalty_shares title_id                          title_name       type pub_id pages price   sales         pubdate pub_id             pub_name          city state country
1    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T01   A01        1            1.0      T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00    P01    Abatis Publishers      New York    NY     USA
2    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T02   A01        1            1.0      T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
3    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T13   A01        1            1.0      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
4    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T06   A02        1            1.0      T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00    P01    Abatis Publishers      New York    NY     USA
5    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T07   A02        1            0.5      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
6    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T10   A02        1            1.0      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;    P05       AAA Publishing      Berkeley    CA     USA
7    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T12   A02        1            1.0      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
8    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A03        1            0.6      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00    P01    Abatis Publishers      New York    NY     USA
9    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A03        2            0.3      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
10   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A04        2            0.4      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00    P01    Abatis Publishers      New York    NY     USA
11   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T05   A04        1            1.0      T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00    P01    Abatis Publishers      New York    NY     USA
12   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A04        2            0.5      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
13   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A04        3            0.3      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
14   A05 Christian     Kells 212-771-4680       114 Horatio St      New York    NY 10014      T03   A05        1            1.0      T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00    P02      Core Dump Books San Francisco    CA     USA
15   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T08   A06        1            1.0      T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00    P01    Abatis Publishers      New York    NY     USA
16   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T09   A06        1            1.0      T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00    P01    Abatis Publishers      New York    NY     USA
17   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A06        1            0.4      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 5 - the select clause specifies which columns are actually displayed</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>sql <span class="ot">=</span> <span class="st">"select pub_name, title_name, au_fname, au_lname,</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="st">              authors.state as 'author state', </span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="st">              publishers.state as 'publisher state'</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="st">    from authors join title_authors on authors.au_id = title_authors.au_id </span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="st">                          join titles on title_authors.title_id = titles.title_id </span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="st">                          join publishers on publishers.pub_id = titles.pub_id</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="st">  order by pub_name, title_name, au_lname, au_fname"</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(sql)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               pub_name                          title_name  au_fname  au_lname author state publisher state
1        AAA Publishing         Not Without My Fabrerge Egg     Wendy Heydemark           CO              CA
2        AAA Publishing    Perhaps It's a Glandular Problem    Hallie      Hull           CA              CA
3        AAA Publishing    Perhaps It's a Glandular Problem      Klee      Hull           CA              CA
4        AAA Publishing    Perhaps It's a Glandular Problem    Harvey   Kellsey           CA              CA
5        AAA Publishing           Spontaneous, Not Annoying     Wendy Heydemark           CO              CA
6     Abatis Publishers                               1977!     Sarah   Buchman           NY              NY
7     Abatis Publishers           But I Did It Unconciously    Hallie      Hull           CA              NY
8     Abatis Publishers           But I Did It Unconciously      Klee      Hull           CA              NY
9     Abatis Publishers              Exchange of Platitudes      Klee      Hull           CA              NY
10    Abatis Publishers                    How About Never?     Wendy Heydemark           CO              NY
11    Abatis Publishers        Just Wait Until After School    Harvey   Kellsey           CA              NY
12    Abatis Publishers                     Kiss My Boo Boo    Harvey   Kellsey           CA              NY
13      Core Dump Books        Ask Yor System Administrator Christian     Kells           NY              CA
14 Schandenfreude Press           200 Years of German Humor     Sarah   Buchman           NY            &lt;NA&gt;
15 Schandenfreude Press                   I Blame My Mother     Wendy Heydemark           CO            &lt;NA&gt;
16 Schandenfreude Press                   I Blame My Mother      Klee      Hull           CA            &lt;NA&gt;
17 Schandenfreude Press What Are The Civilian Applications?     Sarah   Buchman           NY            &lt;NA&gt;</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./sql0010-introToSql-v023.html" class="pagination-link" aria-label="<yrChapterNumber>30. </yrChapterNumber> Intro to Relational Databases and SQL ***(no dplyr required)***">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title"><yrchapternumber>30. </yrchapternumber> Intro to Relational Databases and SQL <strong><em>(no dplyr required)</em></strong></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sql0030-sqlFunctions_aggregateFunctions_groupBy_having-v019.html" class="pagination-link" aria-label="<yrChapterNumber>32. </yrChapterNumber> aggregate functions, group by, having">
        <span class="nav-page-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title"><yrchapternumber>32. </yrchapternumber> aggregate functions, group by, having</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>
const titles = document.querySelectorAll('.title');

titles.forEach(title => {
  if (title.textContent.trim().startsWith('Appendix')) {
    const chapterNumber = title.querySelector('yrChapterNumber');
    if (chapterNumber) {
      chapterNumber.classList.add('yrAppendixChapterNumber');
    }
  }
});
</script>




</body></html>