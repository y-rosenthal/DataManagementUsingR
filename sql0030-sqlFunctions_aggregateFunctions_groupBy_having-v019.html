<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.537">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Management With R - 18&nbsp; aggregate functions, group by, having</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sql0040-crossJoin-leftJoin-subquery-selfJoins-v023.html" rel="next">
<link href="./sql0035-workingWithMultipleTables-v012.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql0006-introToDatabases-v023.html">Relational databases and SQL (no dplyr knowledge needed)</a></li><li class="breadcrumb-item"><a href="./sql0030-sqlFunctions_aggregateFunctions_groupBy_having-v019.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">aggregate functions, group by, having</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Management With R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intro</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000017-introToQuarto-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intro to Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000022-InstallingRPackages-v003.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Intro to R packages</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Bash</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000011-WhatIsACli-v010.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Intro to Command Line Interfaces (CLIs)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000013-HowToRunTheBashShellCli-v011.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">How to run the Bash Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000025-introToBash-v007.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Working with the Bash Shell.</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Regular Expressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0200200-introToRegularExpressions-v036.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">regular expressions (regex)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./000260-PracticeWithRegulaExpressions-v003.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Practice with Regular Expressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Intro to tidyverse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0400050-whatIsTidyverse-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">What is the "tidyverse"</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0400100-usingPipes-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Using pipes, i.e. %&gt;% and |&gt;</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0400200-stringr-tutorials-v003.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">stringr tutorial</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">visualizations with ggplot2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./050050-tdyvrsGgplot2-v0001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Intro to ggplot2</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Intro to dplyr and to SQL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0500100-tdyvrsDplyr-v005.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Intro to dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0500400-sqlSelectIntro-v003.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">SQL Select</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Relational databases and SQL (no dplyr knowledge needed)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0006-introToDatabases-v023.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">"databases" and "database management systems"</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0014-theBooksDatabase-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Get the data - "books database" and other tables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0010-introToSql-v023.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Relational Databases and SQL (using R)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0035-workingWithMultipleTables-v012.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inner Joins.</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0030-sqlFunctions_aggregateFunctions_groupBy_having-v019.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">aggregate functions, group by, having</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0040-crossJoin-leftJoin-subquery-selfJoins-v023.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">more joins (cross/left/right/full), subqueries, set operations, case, self joins</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0050-commonTableExpressions-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Common Table Expressions (CTE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0200-otherSqlCommands-v002.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">other commands: update/delete, create/drop/insert</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0900-sqlWindowFunctions-v002.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">SQL "window" functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql0950-workingWithDatabasesInR-v010.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Working directly with databases in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0600100-introToDb-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">What is a Database?</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Web Scraping</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./web-000300-internetArchitecture-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">How a webpage gets to your browser</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./web-000400-webscrapingContinued-015.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Web Scraping with R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./web-000130-WebscrapingJavascriptSites-v003.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Scraping Dynamic (JavaScript) Websites</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./web-000420-practiceWithWebScraping-v001-ANSWERS-v002.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">CSS Selector questions and answers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Questions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0990100-cleaningData-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">"Cleaning" data</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000100-topics-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Topics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000200-bibliography-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Bibliography</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000300-whereToFindDatasets-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Where to find datasets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0000310-whereToFindApis-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Where to find APIs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0999000-toDo-v001.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Additional topics</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-books-database" id="toc-the-books-database" class="nav-link active" data-scroll-target="#the-books-database"><span class="header-section-number">18.1</span> The “books database”</a></li>
  <li><a href="#click-to-download-the-specified-files" id="toc-click-to-download-the-specified-files" class="nav-link" data-scroll-target="#click-to-download-the-specified-files"><span class="header-section-number">18.2</span> click to download the specified files</a></li>
  <li><a href="#non-aggreate-functions-vs-aggregate-functions" id="toc-non-aggreate-functions-vs-aggregate-functions" class="nav-link" data-scroll-target="#non-aggreate-functions-vs-aggregate-functions"><span class="header-section-number">18.3</span> “non-aggreate functions” vs “aggregate functions”</a>
  <ul class="collapse">
  <li><a href="#the-titles-table" id="toc-the-titles-table" class="nav-link" data-scroll-target="#the-titles-table"><span class="header-section-number">18.3.1</span> The titles table</a></li>
  <li><a href="#example-of-a-non-aggregate-function---upper" id="toc-example-of-a-non-aggregate-function---upper" class="nav-link" data-scroll-target="#example-of-a-non-aggregate-function---upper"><span class="header-section-number">18.3.2</span> Example of a non-aggregate function - upper</a></li>
  <li><a href="#example-of-an-aggregate-function---avg" id="toc-example-of-an-aggregate-function---avg" class="nav-link" data-scroll-target="#example-of-an-aggregate-function---avg"><span class="header-section-number">18.3.3</span> Example of an aggregate function - avg</a></li>
  </ul></li>
  <li><a href="#demonstrating-non-aggreate-functions-with-simple-select-statements" id="toc-demonstrating-non-aggreate-functions-with-simple-select-statements" class="nav-link" data-scroll-target="#demonstrating-non-aggreate-functions-with-simple-select-statements"><span class="header-section-number">18.4</span> Demonstrating non-aggreate functions with simple select statements</a></li>
  <li><a href="#non-aggreate-functions-in-sqlite" id="toc-non-aggreate-functions-in-sqlite" class="nav-link" data-scroll-target="#non-aggreate-functions-in-sqlite"><span class="header-section-number">18.5</span> Non-aggreate functions in SQLite</a>
  <ul class="collapse">
  <li><a href="#upper-and-lower-functions" id="toc-upper-and-lower-functions" class="nav-link" data-scroll-target="#upper-and-lower-functions"><span class="header-section-number">18.5.1</span> upper() and lower() functions</a></li>
  <li><a href="#ltrim-rtrim-trim" id="toc-ltrim-rtrim-trim" class="nav-link" data-scroll-target="#ltrim-rtrim-trim"><span class="header-section-number">18.5.2</span> ltrim() , rtrim() , trim()</a></li>
  <li><a href="#substr-string-start-length" id="toc-substr-string-start-length" class="nav-link" data-scroll-target="#substr-string-start-length"><span class="header-section-number">18.5.3</span> substr( string, start, length )</a></li>
  </ul></li>
  <li><a href="#practice" id="toc-practice" class="nav-link" data-scroll-target="#practice"><span class="header-section-number">18.6</span> Practice</a>
  <ul class="collapse">
  <li><a href="#other-functions-in-sqlite" id="toc-other-functions-in-sqlite" class="nav-link" data-scroll-target="#other-functions-in-sqlite"><span class="header-section-number">18.6.1</span> Other functions in SQLite</a></li>
  </ul></li>
  <li><a href="#aggregate-functions" id="toc-aggregate-functions" class="nav-link" data-scroll-target="#aggregate-functions"><span class="header-section-number">18.7</span> aggregate functions</a></li>
  <li><a href="#dont-mix-aggregate-functions-with-non-aggregated-data" id="toc-dont-mix-aggregate-functions-with-non-aggregated-data" class="nav-link" data-scroll-target="#dont-mix-aggregate-functions-with-non-aggregated-data"><span class="header-section-number">18.8</span> Don’t mix aggregate functions with non-aggregated data</a></li>
  <li><a href="#count-function---three-different-versions" id="toc-count-function---three-different-versions" class="nav-link" data-scroll-target="#count-function---three-different-versions"><span class="header-section-number">18.9</span> count function - three different versions</a></li>
  <li><a href="#min-and-max-also-work-with-character-columns." id="toc-min-and-max-also-work-with-character-columns." class="nav-link" data-scroll-target="#min-and-max-also-work-with-character-columns."><span class="header-section-number">18.10</span> min and max also work with character columns.</a></li>
  <li><a href="#two-diffferent-meanings-of-distinct" id="toc-two-diffferent-meanings-of-distinct" class="nav-link" data-scroll-target="#two-diffferent-meanings-of-distinct"><span class="header-section-number">18.11</span> two diffferent meanings of “distinct”</a></li>
  <li><a href="#using-were-in-queries-that-contain-aggregate-functions" id="toc-using-were-in-queries-that-contain-aggregate-functions" class="nav-link" data-scroll-target="#using-were-in-queries-that-contain-aggregate-functions"><span class="header-section-number">18.12</span> Using WERE in queries that contain aggregate functions</a></li>
  <li><a href="#practice-1" id="toc-practice-1" class="nav-link" data-scroll-target="#practice-1"><span class="header-section-number">18.13</span> Practice</a></li>
  <li><a href="#reminder-about-how-multiple-joins-work" id="toc-reminder-about-how-multiple-joins-work" class="nav-link" data-scroll-target="#reminder-about-how-multiple-joins-work"><span class="header-section-number">18.14</span> Reminder about how multiple joins work</a></li>
  <li><a href="#warning---if-where-clause-removes-all-rows-then-avgsummaxmin-return-null" id="toc-warning---if-where-clause-removes-all-rows-then-avgsummaxmin-return-null" class="nav-link" data-scroll-target="#warning---if-where-clause-removes-all-rows-then-avgsummaxmin-return-null"><span class="header-section-number">18.15</span> WARNING - If where clause removes all rows then avg,sum,max,min return NULL</a></li>
  <li><a href="#practice-2" id="toc-practice-2" class="nav-link" data-scroll-target="#practice-2"><span class="header-section-number">18.16</span> Practice</a></li>
  <li><a href="#dont-use-aggregate-functions-non-aggregated-values-in-same-select-clause" id="toc-dont-use-aggregate-functions-non-aggregated-values-in-same-select-clause" class="nav-link" data-scroll-target="#dont-use-aggregate-functions-non-aggregated-values-in-same-select-clause"><span class="header-section-number">18.17</span> DON’T use aggregate functions &amp; non-aggregated values in same select clause</a></li>
  <li><a href="#order-of-clauses-select-from-where-group-by-having-order-by-limit" id="toc-order-of-clauses-select-from-where-group-by-having-order-by-limit" class="nav-link" data-scroll-target="#order-of-clauses-select-from-where-group-by-having-order-by-limit"><span class="header-section-number">18.18</span> ORDER OF CLAUSES: select, from, where, group by, having, order by, limit</a></li>
  <li><a href="#group-by-affects-how-aggregate-functions-work" id="toc-group-by-affects-how-aggregate-functions-work" class="nav-link" data-scroll-target="#group-by-affects-how-aggregate-functions-work"><span class="header-section-number">18.19</span> GROUP BY affects how aggregate functions work</a></li>
  <li><a href="#practice-3" id="toc-practice-3" class="nav-link" data-scroll-target="#practice-3"><span class="header-section-number">18.20</span> Practice</a></li>
  <li><a href="#group-by-more-than-one-column" id="toc-group-by-more-than-one-column" class="nav-link" data-scroll-target="#group-by-more-than-one-column"><span class="header-section-number">18.21</span> GROUP BY more than one column</a></li>
  <li><a href="#practice-4" id="toc-practice-4" class="nav-link" data-scroll-target="#practice-4"><span class="header-section-number">18.22</span> Practice</a></li>
  <li><a href="#having-clause" id="toc-having-clause" class="nav-link" data-scroll-target="#having-clause"><span class="header-section-number">18.23</span> HAVING clause</a></li>
  <li><a href="#using-where-and-having-in-the-same-query---a-detailed-analysis" id="toc-using-where-and-having-in-the-same-query---a-detailed-analysis" class="nav-link" data-scroll-target="#using-where-and-having-in-the-same-query---a-detailed-analysis"><span class="header-section-number">18.24</span> using where and having in the same query - a detailed analysis</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql0006-introToDatabases-v023.html">Relational databases and SQL (no dplyr knowledge needed)</a></li><li class="breadcrumb-item"><a href="./sql0030-sqlFunctions_aggregateFunctions_groupBy_having-v019.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">aggregate functions, group by, having</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">aggregate functions, group by, having</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="the-books-database" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="the-books-database"><span class="header-section-number">18.1</span> The “books database”</h2>
<p>In this and other sections we will be referring to the “books database”.</p>
<p>Click below to download a document that describes the books database and database technology in general. This document also contains many questions/answers to test your knowledge of SQL. You can also download the CSV files that contain the data for the books database.</p>
</section>
<section id="click-to-download-the-specified-files" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="click-to-download-the-specified-files"><span class="header-section-number">18.2</span> click to download the specified files</h2>
<ul>
<li><a href="data/booksDatabaseDescription-withQuestions-ANSWERS-v020.docx">booksDatabase description and Questions</a></li>
<li><a href="data/booksDatabase/titles.csv">titles.csv</a></li>
<li><a href="data/booksDatabase/authors.csv">authors.csv</a></li>
<li><a href="data/booksDatabase/publishers.csv">publishers.csv</a></li>
<li><a href="data/booksDatabase/title_authors.csv">title_authors.csv</a></li>
<li><a href="data/booksDatabase/royalties.csv">royalties.csv</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the package we'll need</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(sqldf)) { <span class="fu">install.packages</span>(<span class="st">"sqldf"</span>); <span class="fu">require</span>(sqldf) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sqldf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gsubfn</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: proto</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: RSQLite</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(readr)) { <span class="fu">install.packages</span>(<span class="st">"readr"</span>); <span class="fu">require</span>(readr) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: readr</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the data for the books database - see the </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>titles <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/booksDatabase/titles.csv"</span>, <span class="at">na=</span><span class="st">"NULL"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>authors <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/booksDatabase/authors.csv"</span>, <span class="at">na=</span><span class="st">"NULL"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>publishers <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/booksDatabase/publishers.csv"</span>, <span class="at">na=</span><span class="st">"NULL"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>title_authors <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/booksDatabase/title_authors.csv"</span>, <span class="at">na=</span><span class="st">"NULL"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>royalties <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/booksDatabase/royalties.csv"</span>, <span class="at">na=</span><span class="st">"NULL"</span>, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="non-aggreate-functions-vs-aggregate-functions" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="non-aggreate-functions-vs-aggregate-functions"><span class="header-section-number">18.3</span> “non-aggreate functions” vs “aggregate functions”</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Intro to SQL functions:</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   SQL contains two different types of functions</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   - non-aggregate functions - return a different value for every row</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   - aggregate functions - return a single value for multiple rows in the table</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     These functions combine several data values in a single value. </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     For example the sum function will combine several values into a single sum.</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     see below for more details</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-titles-table" class="level3" data-number="18.3.1">
<h3 data-number="18.3.1" class="anchored" data-anchor-id="the-titles-table"><span class="header-section-number">18.3.1</span> The titles table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's remember what is in the titles table.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select * from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name       type pub_id pages price   sales         pubdate
1       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00
2       T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00
3       T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00
4       T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00
5       T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00
6       T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00
7       T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00
8       T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00
9       T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00
10      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;
11      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00
12      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00
13      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00</code></pre>
</div>
</div>
</section>
<section id="example-of-a-non-aggregate-function---upper" class="level3" data-number="18.3.2">
<h3 data-number="18.3.2" class="anchored" data-anchor-id="example-of-a-non-aggregate-function---upper"><span class="header-section-number">18.3.2</span> Example of a non-aggregate function - upper</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#................................................................</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of non-aggregate function</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The upper function simply transforms its argument to UPPERCASE.</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#................................................................</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># we can get just the titles and the prices:</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, price from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name price
1                                1977! 21.99
2            200 Years of German Humor 19.95
3         Ask Yor System Administrator 39.95
4            But I Did It Unconciously 12.99
5               Exchange of Platitudes  6.95
6                     How About Never? 19.95
7                    I Blame My Mother 23.95
8         Just Wait Until After School 10.00
9                      Kiss My Boo Boo 13.95
10         Not Without My Fabrerge Egg    NA
11    Perhaps It's a Glandular Problem  7.99
12           Spontaneous, Not Annoying 12.99
13 What Are The Civilian Applications? 29.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following uses the upper function to make each title UPPER CASE</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select upper(title_name), price from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     upper(title_name) price
1                                1977! 21.99
2            200 YEARS OF GERMAN HUMOR 19.95
3         ASK YOR SYSTEM ADMINISTRATOR 39.95
4            BUT I DID IT UNCONCIOUSLY 12.99
5               EXCHANGE OF PLATITUDES  6.95
6                     HOW ABOUT NEVER? 19.95
7                    I BLAME MY MOTHER 23.95
8         JUST WAIT UNTIL AFTER SCHOOL 10.00
9                      KISS MY BOO BOO 13.95
10         NOT WITHOUT MY FABRERGE EGG    NA
11    PERHAPS IT'S A GLANDULAR PROBLEM  7.99
12           SPONTANEOUS, NOT ANNOYING 12.99
13 WHAT ARE THE CIVILIAN APPLICATIONS? 29.99</code></pre>
</div>
</div>
</section>
<section id="example-of-an-aggregate-function---avg" class="level3" data-number="18.3.3">
<h3 data-number="18.3.3" class="anchored" data-anchor-id="example-of-an-aggregate-function---avg"><span class="header-section-number">18.3.3</span> Example of an aggregate function - avg</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#................................................................</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of an aggregate function</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The avg function takes the average of a set of a set of values.</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#................................................................</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># show all the prices</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select price from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   price
1  21.99
2  19.95
3  39.95
4  12.99
5   6.95
6  19.95
7  23.95
8  10.00
9  13.95
10    NA
11  7.99
12 12.99
13 29.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the average of the prices</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select avg(price) from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  avg(price)
1    18.3875</code></pre>
</div>
</div>
</section>
</section>
<section id="demonstrating-non-aggreate-functions-with-simple-select-statements" class="level2" data-number="18.4">
<h2 data-number="18.4" class="anchored" data-anchor-id="demonstrating-non-aggreate-functions-with-simple-select-statements"><span class="header-section-number">18.4</span> Demonstrating non-aggreate functions with simple select statements</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># queries with JUST a select clause</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># It's not the most common thing to do but you can write a select statement</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># that does not actually retrieve any information from any table. </span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The purpose is to use the SQL language to calculate values, similar to</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># how you can use R or a calculator to calculate sums, products, etc.</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># This feature will help us demonstrate some of the sql functions below.</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Example:</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># perform some calculations and display the results</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select 3+2,   10*2,   23/5,   23.0/5"</span>)    <span class="co"># show the results of various calculations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  3+2 10*2 23/5 23.0/5
1   5   20    4    4.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can include our own names for the columns.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># When you change the name of a column, the new column name is known as a 'column alias'</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select 3+2 as A,   10*2 as B,   23/5 as C,   23.0/5 as D"</span>)    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A  B C   D
1 5 20 4 4.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You don't need the "as" when creating column aliases</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ... but some people do so anyway since it reads nicer with the "as"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># same results as above</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select 3+2 A,   10*2 B,   23/5 C,   23.0/5 D"</span>)    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A  B C   D
1 5 20 4 4.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following is not really doing anything useful but it</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># helps to demonstrate what the upper function does.</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This technique is used on the sqlitetutorial.net website</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># to demonstrate how many of the SQLite functions work. </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For example, click on the specific function names you find on the following</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># page for more info about the functions and examples of using the functions.</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   https://www.sqlitetutorial.net/sqlite-string-functions/</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select upper('abcde')"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  upper('abcde')
1          ABCDE</code></pre>
</div>
</div>
</section>
<section id="non-aggreate-functions-in-sqlite" class="level2" data-number="18.5">
<h2 data-number="18.5" class="anchored" data-anchor-id="non-aggreate-functions-in-sqlite"><span class="header-section-number">18.5</span> Non-aggreate functions in SQLite</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-aggregate functions in SQLite</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The non-aggregate functions are NOT defined as part of the ANSI SQL standard.</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Every database management system software offers their own versions of </span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># non-aggregate functions.  For example, MySQL, Microsoft SQL Server, Postgres</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># and sqlite all have different non-aggregate functions that they make available.</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co"># To undertand how to use these function, you need to see the documentation</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># for your particular version of SQL. See the following webpage for</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co"># some functions in SQLite. We will first look at the </span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co"># "string functions" i.e. functions that work with "string" values</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># (i.e. character values):</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     https://www.sqlitetutorial.net/sqlite-string-functions/</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="co"># The string functions available in sqlite are the following.</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># See the website for more details:</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co">#    substr, trim, rtrim, ltrim, length, replace, upper, lower, instr</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="co"># first let's remember what is in the titles table</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select * from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name       type pub_id pages price   sales         pubdate
1       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00
2       T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00
3       T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00
4       T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00
5       T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00
6       T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00
7       T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00
8       T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00
9       T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00
10      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;
11      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00
12      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00
13      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00</code></pre>
</div>
</div>
<section id="upper-and-lower-functions" class="level3" data-number="18.5.1">
<h3 data-number="18.5.1" class="anchored" data-anchor-id="upper-and-lower-functions"><span class="header-section-number">18.5.1</span> upper() and lower() functions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#........................................................</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># upper ( character_value ) - returns the UPPERCASE version of the character value</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lower ( character_value ) - returns the lowercase version of the character value</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#........................................................</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># show first 5 titles </span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="st">       limit 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    title_name
1                        1977!
2    200 Years of German Humor
3 Ask Yor System Administrator
4    But I Did It Unconciously
5       Exchange of Platitudes</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the first 5 titles in UPPERCASE</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select upper(title_name)</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="st">      limit 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             upper(title_name)
1                        1977!
2    200 YEARS OF GERMAN HUMOR
3 ASK YOR SYSTEM ADMINISTRATOR
4    BUT I DID IT UNCONCIOUSLY
5       EXCHANGE OF PLATITUDES</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a more friendly column name (i.e. a 'column alias').</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e. display "title" at the top of the column instead of "upper(title_name)"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select upper(title_name) as title</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="st">      limit 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         title
1                        1977!
2    200 YEARS OF GERMAN HUMOR
3 ASK YOR SYSTEM ADMINISTRATOR
4    BUT I DID IT UNCONCIOUSLY
5       EXCHANGE OF PLATITUDES</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show both the original title and the uppercase version in the same query</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, upper(title_name) as TITLE_NAME</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="st">      limit 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    title_name                   TITLE_NAME
1                        1977!                        1977!
2    200 Years of German Humor    200 YEARS OF GERMAN HUMOR
3 Ask Yor System Administrator ASK YOR SYSTEM ADMINISTRATOR
4    But I Did It Unconciously    BUT I DID IT UNCONCIOUSLY
5       Exchange of Platitudes       EXCHANGE OF PLATITUDES</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the title in addition to other information</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select upper(title_name) as TITLE_NAME, price</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="st">      limit 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    TITLE_NAME price
1                        1977! 21.99
2    200 YEARS OF GERMAN HUMOR 19.95
3 ASK YOR SYSTEM ADMINISTRATOR 39.95
4    BUT I DID IT UNCONCIOUSLY 12.99
5       EXCHANGE OF PLATITUDES  6.95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In SQLite, you can use the * along with other column names</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># but note that this is not standard.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Not every SQL will accept the * unless it is the only value in the select clause.</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that the * stands in for ALL column names, including the title_name</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># even though you already displayed the title_name.</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select upper(title_name) as TITLE_NAME, *</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="st">       limit 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    TITLE_NAME title_id                   title_name       type pub_id pages price  sales        pubdate
1                        1977!      T01                        1977!    history    P01   107 21.99    566  8/1/2000 0:00
2    200 YEARS OF GERMAN HUMOR      T02    200 Years of German Humor    history    P03    14 19.95   9566  4/1/1998 0:00
3 ASK YOR SYSTEM ADMINISTRATOR      T03 Ask Yor System Administrator   computer    P02  1226 39.95  25667  9/1/2000 0:00
4    BUT I DID IT UNCONCIOUSLY      T04    But I Did It Unconciously psychology    P01   510 12.99  13001 5/31/1999 0:00
5       EXCHANGE OF PLATITUDES      T05       Exchange of Platitudes psychology    P01   201  6.95 201440  1/1/2001 0:00</code></pre>
</div>
</div>
</section>
<section id="ltrim-rtrim-trim" class="level3" data-number="18.5.2">
<h3 data-number="18.5.2" class="anchored" data-anchor-id="ltrim-rtrim-trim"><span class="header-section-number">18.5.2</span> ltrim() , rtrim() , trim()</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................................................................</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ltrim ( string, [character] )</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rtrim ( string, [character] )   </span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># trim  ( string, [character] )</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ARGUMENTS</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   - string - the value to be modified</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   - [character] </span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     The [brackets] in the documenation indicate that this value is optional.</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     If specified, this is expected to be a string (ie. a character value </span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     enclosed in 'single quotes'). The characters in the string will be removed</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     from the left (or right) hand side of the string:</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co">#        the l in ltrim stands for left</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co">#        the r in rtrim stands for right</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="co">#.........................................................................</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="co"># let's see the original data</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, pubdate</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name         pubdate
1                                1977!   8/1/2000 0:00
2            200 Years of German Humor   4/1/1998 0:00
3         Ask Yor System Administrator   9/1/2000 0:00
4            But I Did It Unconciously  5/31/1999 0:00
5               Exchange of Platitudes   1/1/2001 0:00
6                     How About Never?  7/31/2000 0:00
7                    I Blame My Mother  10/1/1999 0:00
8         Just Wait Until After School   6/1/2001 0:00
9                      Kiss My Boo Boo  5/31/2002 0:00
10         Not Without My Fabrerge Egg            &lt;NA&gt;
11    Perhaps It's a Glandular Problem 11/30/2000 0:00
12           Spontaneous, Not Annoying  8/31/2000 0:00
13 What Are The Civilian Applications?  5/31/1999 0:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get rid of the time indicator from the end of the pubdate</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, rtrim(pubdate, '0:') as publication_date</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name publication_date
1                                1977!        8/1/2000 
2            200 Years of German Humor        4/1/1998 
3         Ask Yor System Administrator        9/1/2000 
4            But I Did It Unconciously       5/31/1999 
5               Exchange of Platitudes        1/1/2001 
6                     How About Never?       7/31/2000 
7                    I Blame My Mother       10/1/1999 
8         Just Wait Until After School        6/1/2001 
9                      Kiss My Boo Boo       5/31/2002 
10         Not Without My Fabrerge Egg             &lt;NA&gt;
11    Perhaps It's a Glandular Problem      11/30/2000 
12           Spontaneous, Not Annoying       8/31/2000 
13 What Are The Civilian Applications?       5/31/1999 </code></pre>
</div>
</div>
</section>
<section id="substr-string-start-length" class="level3" data-number="18.5.3">
<h3 data-number="18.5.3" class="anchored" data-anchor-id="substr-string-start-length"><span class="header-section-number">18.5.3</span> substr( string, start, length )</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#........................................................</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># substr ( string, start, length)</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># returns a "substring", i.e. a portion of the string (ie. charcter value).</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ARGUMENTS:</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co">#    start - the position to start taking info from</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co">#    length - the number of characters to include</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">#........................................................</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># get just the number from the title_id</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_id, substr(title_id, 2, 2) as title_number from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id title_number
1       T01           01
2       T02           02
3       T03           03
4       T04           04
5       T05           05
6       T06           06
7       T07           07
8       T08           08
9       T09           09
10      T10           10
11      T11           11
12      T12           12
13      T13           13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If length is too long the rest of the string is taken.</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_id, substr(title_id, 2, 200) as title_number from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id title_number
1       T01           01
2       T02           02
3       T03           03
4       T04           04
5       T05           05
6       T06           06
7       T07           07
8       T08           08
9       T09           09
10      T10           10
11      T11           11
12      T12           12
13      T13           13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># abbreviate the title</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, substr(title_name, 1, 20) as abbreviated_title from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name    abbreviated_title
1                                1977!                1977!
2            200 Years of German Humor 200 Years of German 
3         Ask Yor System Administrator Ask Yor System Admin
4            But I Did It Unconciously But I Did It Unconci
5               Exchange of Platitudes Exchange of Platitud
6                     How About Never?     How About Never?
7                    I Blame My Mother    I Blame My Mother
8         Just Wait Until After School Just Wait Until Afte
9                      Kiss My Boo Boo      Kiss My Boo Boo
10         Not Without My Fabrerge Egg Not Without My Fabre
11    Perhaps It's a Glandular Problem Perhaps It's a Gland
12           Spontaneous, Not Annoying Spontaneous, Not Ann
13 What Are The Civilian Applications? What Are The Civilia</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># abbreviate the title (add on '...' at the end of every value - not just the ones that were shortened)</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, substr(title_name, 1, 20) || ' ...' as abbreviated_title from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name        abbreviated_title
1                                1977!                1977! ...
2            200 Years of German Humor 200 Years of German  ...
3         Ask Yor System Administrator Ask Yor System Admin ...
4            But I Did It Unconciously But I Did It Unconci ...
5               Exchange of Platitudes Exchange of Platitud ...
6                     How About Never?     How About Never? ...
7                    I Blame My Mother    I Blame My Mother ...
8         Just Wait Until After School Just Wait Until Afte ...
9                      Kiss My Boo Boo      Kiss My Boo Boo ...
10         Not Without My Fabrerge Egg Not Without My Fabre ...
11    Perhaps It's a Glandular Problem Perhaps It's a Gland ...
12           Spontaneous, Not Annoying Spontaneous, Not Ann ...
13 What Are The Civilian Applications? What Are The Civilia ...</code></pre>
</div>
</div>
</section>
</section>
<section id="practice" class="level2" data-number="18.6">
<h2 data-number="18.6" class="anchored" data-anchor-id="practice"><span class="header-section-number">18.6</span> Practice</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Write a select statement that retrieves all books that were published </span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># during a month with a single digit.</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ANSWER</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select *</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="st">       where substr(pubdate, 2, 1) = '/'</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="st">       order by title_name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name       type pub_id pages price  sales        pubdate
1       T01                               1977!    history    P01   107 21.99    566  8/1/2000 0:00
2       T02           200 Years of German Humor    history    P03    14 19.95   9566  4/1/1998 0:00
3       T03        Ask Yor System Administrator   computer    P02  1226 39.95  25667  9/1/2000 0:00
4       T04           But I Did It Unconciously psychology    P01   510 12.99  13001 5/31/1999 0:00
5       T05              Exchange of Platitudes psychology    P01   201  6.95 201440  1/1/2001 0:00
6       T06                    How About Never?  biography    P01   473 19.95  11320 7/31/2000 0:00
7       T08        Just Wait Until After School   children    P01    86 10.00   4095  6/1/2001 0:00
8       T09                     Kiss My Boo Boo   children    P01    22 13.95   5000 5/31/2002 0:00
9       T12           Spontaneous, Not Annoying  biography    P05   507 12.99 100001 8/31/2000 0:00
10      T13 What Are The Civilian Applications?    history    P03   802 29.99  10467 5/31/1999 0:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Question</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Write a select statement that lists the title_name, type and publication date</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># of those books that were published in October, November or December </span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (i.e. months whose numeric value is 2 digits)</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ANSWER</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co"># We could simply use != </span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, type, pubdate</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="st">       where substr(pubdate, 2, 1) != '/'</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="st">       order by pubdate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        title_name       type         pubdate
1                I Blame My Mother  biography  10/1/1999 0:00
2 Perhaps It's a Glandular Problem psychology 11/30/2000 0:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANSWER</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># One way: Identify those rows that have a 2 digit month as those rows which</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># have a '/' in the 3rd position of the pubdate.</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that the books with a 1 digit months in the pubdate</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co"># do not appear in the results.</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, type, pubdate </span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="st">       where substr(pubdate, 3, 1) = '/'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        title_name       type         pubdate
1                I Blame My Mother  biography  10/1/1999 0:00
2 Perhaps It's a Glandular Problem psychology 11/30/2000 0:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Another way: Identify those rows for which the first 2 characters of the </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pubdate are '10', '11' or '12'</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, type, pubdate </span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="st">       where substr(pubdate, 1, 2) in ('10','11','12')</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        title_name       type         pubdate
1                I Blame My Mother  biography  10/1/1999 0:00
2 Perhaps It's a Glandular Problem psychology 11/30/2000 0:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Question</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Write a select statement that lists the title_name and day of the month </span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># that each title was published.</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ANSWER</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co"># To find the day of the month, let's first trim away the numbers from the </span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># left and the right. Then we'll trim away the /'s from the left and the right</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># to leave just the day of the month.</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll start by just trimming away the numbers spaces and colons.</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, trim(pubdate, '0123456789: ') </span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name trim(pubdate, '0123456789: ')
1                                1977!                           /1/
2            200 Years of German Humor                           /1/
3         Ask Yor System Administrator                           /1/
4            But I Did It Unconciously                          /31/
5               Exchange of Platitudes                           /1/
6                     How About Never?                          /31/
7                    I Blame My Mother                           /1/
8         Just Wait Until After School                           /1/
9                      Kiss My Boo Boo                          /31/
10         Not Without My Fabrerge Egg                          &lt;NA&gt;
11    Perhaps It's a Glandular Problem                          /30/
12           Spontaneous, Not Annoying                          /31/
13 What Are The Civilian Applications?                          /31/</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now for the final answer we can also trim away the slashes</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, trim(trim(pubdate, '0123456789: '),'/') as dayOfMonth</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name dayOfMonth
1                                1977!          1
2            200 Years of German Humor          1
3         Ask Yor System Administrator          1
4            But I Did It Unconciously         31
5               Exchange of Platitudes          1
6                     How About Never?         31
7                    I Blame My Mother          1
8         Just Wait Until After School          1
9                      Kiss My Boo Boo         31
10         Not Without My Fabrerge Egg       &lt;NA&gt;
11    Perhaps It's a Glandular Problem         30
12           Spontaneous, Not Annoying         31
13 What Are The Civilian Applications?         31</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co"> - the following DOES NOT WORK - because it trims off EVERY</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name, trim(pubdate, '0123456789: /') as dayOfMonth</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name dayOfMonth
1                                1977!           
2            200 Years of German Humor           
3         Ask Yor System Administrator           
4            But I Did It Unconciously           
5               Exchange of Platitudes           
6                     How About Never?           
7                    I Blame My Mother           
8         Just Wait Until After School           
9                      Kiss My Boo Boo           
10         Not Without My Fabrerge Egg       &lt;NA&gt;
11    Perhaps It's a Glandular Problem           
12           Spontaneous, Not Annoying           
13 What Are The Civilian Applications?           </code></pre>
</div>
</div>
<section id="other-functions-in-sqlite" class="level3" data-number="18.6.1">
<h3 data-number="18.6.1" class="anchored" data-anchor-id="other-functions-in-sqlite"><span class="header-section-number">18.6.1</span> Other functions in SQLite</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># see these webpages for examples of the other functions</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co">#    https://www.sqlitetutorial.net/sqlite-functions/sqlite-instr/</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co">#    https://www.techonthenet.com/sqlite/functions/index.php</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="aggregate-functions" class="level2" data-number="18.7">
<h2 data-number="18.7" class="anchored" data-anchor-id="aggregate-functions"><span class="header-section-number">18.7</span> aggregate functions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate functions</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate functions take a bunch of values as input and return a single value.</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For example the avg function averages together several numbers and returns</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co"># a single number.</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The following are standard aggregate functions that are included with </span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co"># every version of SQL. These are part of the ANSI standard for SQL.</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co"># These are the aggregagte functions that we will focus on. </span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   sum, avg, count, min, max</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Different database management systems might include some other aggregate</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="co"># functions in addition to these. See the documentation for your particular</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="co"># database management system for more info about other aggregate functions.</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the contents of the titles table</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select * from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name       type pub_id pages price   sales         pubdate
1       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00
2       T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00
3       T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00
4       T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00
5       T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00
6       T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00
7       T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00
8       T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00
9       T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00
10      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;
11      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00
12      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00
13      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the average price, minimum (i.e. lowest) price and maximum (ie. highest price) </span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># of all the titles</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select avg(price),  min(price) , max(price)</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  avg(price) min(price) max(price)
1    18.3875       6.95      39.95</code></pre>
</div>
</div>
</section>
<section id="dont-mix-aggregate-functions-with-non-aggregated-data" class="level2" data-number="18.8">
<h2 data-number="18.8" class="anchored" data-anchor-id="dont-mix-aggregate-functions-with-non-aggregated-data"><span class="header-section-number">18.8</span> Don’t mix aggregate functions with non-aggregated data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># DO NO MIX AGGREGATE FUNCTIONS WITH NON-AGGREGATED DATA.</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># IN MANY SQL DBMS's YOU WILL GET AN ERROR IF YOU TRY TO DO THIS.</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sqlite does NOT report an error if you do this but the results will not </span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># make much sense. </span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co"># The following shows that in sqlite when you mix aggregate functions </span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co"># with non-aggregated data the results are confusing. Don't do this!</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Some DBMS's will return an ERROR for this query. sqlite does not return</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="co"># an error but the results are very misleading.</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="co"># For example the following is the result of the code below:</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="co">#    &gt; sqldf("select avg(price), sum(pages),  title_name, type</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="co">#             from titles")</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="co">#       avg(price) sum(pages) title_name    type</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="co">#          18.3875       5107      1977! history</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a><span class="co"># The avg function and the sum function return aggregagated data for all of</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="co"># the rows in the titles table. Specically the average price of all the books</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="co"># and the total number of pages from all the books. </span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a><span class="co"># However, the title_name and type columns simply display</span></span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a><span class="co"># the name of a specific book. The title_name and type that is displayed</span></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a><span class="co"># has nothing to do with the avg(price) and sum(pages). The exact book </span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a><span class="co"># that is displayed is really not predictable.</span></span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Bottom line - do NOT mix aggregrate functions, e.g. avg(price), sum(paes)</span></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a><span class="co"># with non-aggregated data, e.g. title_name, type</span></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a><span class="co"># DON'T DO THIS!!! - see the comment above.</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select avg(price), sum(pages),  title_name, type</span></span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  avg(price) sum(pages) title_name    type
1    18.3875       5107      1977! history</code></pre>
</div>
</div>
</section>
<section id="count-function---three-different-versions" class="level2" data-number="18.9">
<h2 data-number="18.9" class="anchored" data-anchor-id="count-function---three-different-versions"><span class="header-section-number">18.9</span> count function - three different versions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># count function - three different versions</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The count function counts the number of rows returned.</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># There are three different versions of the count function</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   count(SOME_COLUMN) </span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     This returns the number of rows for the column that are NOT NULL. </span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     (Remember that in SQL NULL is basically the same as NA in R. </span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co">#      Since we are using sqldf to analyze R dataframes instead of actual </span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co">#      database tables, NA, is treated as NULL</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co">#      ie. when using sqldf, count(SOME_COLUMN) will return the number of </span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="co">#          rows in that column that don't contain NA.</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   count(*) - returns the number of rows. This version counts all rows, including</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="co">#              NULL values and non-distinct values</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="co">#              Note that count is the ONLY aggregate function that can be used </span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="co">#              in this way.</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   count(distinct SOME_COLUMN) - Returns the number of DISTINCT values</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 (i.e. different unique values) in the column.</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 Note that other aggregate functions MAY ALSO</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 be used in this way, eg. avg(distinct price) </span></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 will average the distinct prices.</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 </span></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------</span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a><span class="co"># show all of the data in the titles table</span></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select * from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name       type pub_id pages price   sales         pubdate
1       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00
2       T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00
3       T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00
4       T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00
5       T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00
6       T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00
7       T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00
8       T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00
9       T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00
10      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;
11      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00
12      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00
13      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show various aggregate function values for the titles column</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select sum(price) , avg(price) , avg(DISTINCT price), count(*), count(price) , count(DISTINCT price), min(price) , max(price), count(type), count(DISTINCT type)</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sum(price) avg(price) avg(DISTINCT price) count(*) count(price) count(DISTINCT price) min(price) max(price) count(type) count(DISTINCT type)
1     220.65    18.3875              18.771       13           12                    10       6.95      39.95          13                    5</code></pre>
</div>
</div>
</section>
<section id="min-and-max-also-work-with-character-columns." class="level2" data-number="18.10">
<h2 data-number="18.10" class="anchored" data-anchor-id="min-and-max-also-work-with-character-columns."><span class="header-section-number">18.10</span> min and max also work with character columns.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># min and max also work with character columns.</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># min value of a character column is the value that would appear FIRST in alphabetical order.</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># max value of a character column is the value that would appear LAST  in alphabetical order.</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select min(type), max(type), count(*), count(type), count(DISTINCT type)</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  min(type)  max(type) count(*) count(type) count(DISTINCT type)
1 biography psychology       13          13                    5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co"># WRite a query to display the different types of books. </span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the results alphabetically.</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Only include each type once.</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select distinct type from titles order by type asc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type
1  biography
2   children
3   computer
4    history
5 psychology</code></pre>
</div>
</div>
</section>
<section id="two-diffferent-meanings-of-distinct" class="level2" data-number="18.11">
<h2 data-number="18.11" class="anchored" data-anchor-id="two-diffferent-meanings-of-distinct"><span class="header-section-number">18.11</span> two diffferent meanings of “distinct”</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># two diffferent meanings of "distinct"</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The word "distinct" means two toally different things based on </span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co"># where it appears in the select command.</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. select ... count (distinct SOME_COLUMN) ...</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="co">#    see above</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. select distinct COLUMN1, COLUMN2, ...</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="co">#    When "distinct" appears right after the word select, it </span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    means that the output should not include rows that are </span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="co">#    exact duplicates of each other - in that case only one of the </span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    duplicates is returned.</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a><span class="co"># show all the different types of titles (do not show duplicates)</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select DISTINCT type</span></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type
1    history
2   computer
3 psychology
4  biography
5   children</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show just the entire contents of the type column</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         type
1     history
2     history
3    computer
4  psychology
5  psychology
6   biography
7   biography
8    children
9    children
10  biography
11 psychology
12  biography
13    history</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------------------------------------------------</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># "select distinct ..."  works on ENTIRE ROWS, not individual columns.</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the following two queries. Notice that distinct works on entire</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rows of output to eliminate those rows that are duplicates. </span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Queries that contain more than one column  could still result with duplicate</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co"># values in each column even when DISTINCT is specified. DISTINCT only serves</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co"># to eliminate entire rows of data that are exact duplicates.</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the following 2 queries ...</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------------------------------------------------------------</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="co"># show the entire contents of the type and pub_id columns</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="co"># sort the results by type and then by pub_id within each type</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="co"># notice in the output that some rows are exact duplicates of each other</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, pub_id</span></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a><span class="st">      order by type, pub_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         type pub_id
1   biography    P01
2   biography    P03
3   biography    P05
4   biography    P05
5    children    P01
6    children    P01
7    computer    P02
8     history    P01
9     history    P03
10    history    P03
11 psychology    P01
12 psychology    P01
13 psychology    P05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do the same thing but use "distinct" to eliminate the duplicate rows.</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice in the output that even though "distinct" is specified, each column</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># in the result DOES have duplicate values. Hoewver, there are no rows in the</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="co"># output that are exact duplicates of each other.</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select distinct type, pub_id</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="st">      order by type, pub_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type pub_id
1  biography    P01
2  biography    P03
3  biography    P05
4   children    P01
5   computer    P02
6    history    P01
7    history    P03
8 psychology    P01
9 psychology    P05</code></pre>
</div>
</div>
</section>
<section id="using-were-in-queries-that-contain-aggregate-functions" class="level2" data-number="18.12">
<h2 data-number="18.12" class="anchored" data-anchor-id="using-were-in-queries-that-contain-aggregate-functions"><span class="header-section-number">18.12</span> Using WERE in queries that contain aggregate functions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Using WERE in queries that contain aggregate functions</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate functions work only on rows that are included by the WHERE clause.</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co"># show the complete titles table</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span> (<span class="st">"select * from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name       type pub_id pages price   sales         pubdate
1       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00
2       T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00
3       T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00
4       T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00
5       T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00
6       T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00
7       T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00
8       T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00
9       T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00
10      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;
11      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00
12      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00
13      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the number of titles in the titles table</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The highest price and the average price.</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>( <span class="st">"select count(*), max(price), avg(price) </span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="st">        from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  count(*) max(price) avg(price)
1       13      39.95    18.3875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the number of biographies,</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the highest price for a biography and the average price for a biography</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co"># HINT: use the where clause</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>( <span class="st">"select count(*), max(price), avg(price)</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="st">        from titles</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="st">        where type = 'biography'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  count(*) max(price) avg(price)
1        4      23.95   18.96333</code></pre>
</div>
</div>
</section>
<section id="practice-1" class="level2" data-number="18.13">
<h2 data-number="18.13" class="anchored" data-anchor-id="practice-1"><span class="header-section-number">18.13</span> Practice</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Practice Questions</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Question:</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Write a query that shows the names of the authors who have written at least one book</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="co"># for which they got 1.00 of the royalty share.</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the author's names in alphabetical order.</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Do not repeat the same author's name twice</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="co"># HINTS</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Which tables do you need to include in your query?</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    Make sure to join all of those tables and any intervening tables</span></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Use DISTINCT at the front of your query to eliminate duplicate rows.</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Use "order by" to display the author's names in alphabetical order. Remember</span></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a><span class="co">#    that last name is more significant than first name when arranging names</span></span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a><span class="co">#    in alphabetical order.</span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Answer:</span></span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select distinct au_fname, au_lname</span></span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a><span class="st">       from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a><span class="st">       where royalty_shares = 1.0</span></span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a><span class="st">       order by au_lname asc, au_fname asc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_fname  au_lname
1     Sarah   Buchman
2     Wendy Heydemark
3      Klee      Hull
4 Christian     Kells
5    Harvey   Kellsey</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># notice what will happen if you leave out the distinct</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select au_fname, au_lname</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="st">       from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="st">       where royalty_shares = 1.0</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="st">       order by au_lname asc, au_fname asc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    au_fname  au_lname
1      Sarah   Buchman
2      Sarah   Buchman
3      Sarah   Buchman
4      Wendy Heydemark
5      Wendy Heydemark
6      Wendy Heydemark
7       Klee      Hull
8  Christian     Kells
9     Harvey   Kellsey
10    Harvey   Kellsey</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Question</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Write a query that shows the names of the authors who have written at least one book</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for which the book has a royalty_rate of at least .06</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the author's names in alphabetical order.</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Do not repeat the same author's name twice.</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="co"># HINTS</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. which tables do you need to include in your query?</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    make sure to join all of those tables and any intervening tables</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Use DISTINCT at the front of your query to eliminate duplicate rows.</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Use "order by" to display the author's names in alphabetical order. Remember</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a><span class="co">#    that last name is more significant than first name when arranging names</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    in alphabetical order.</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a><span class="co"># First attempt ...</span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Not the answer yet ...</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's start out by including the royalty_rate in the select clause. This lets</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a><span class="co"># us see that we indeed are only getting authors who contributed to a book </span></span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="co"># whose royalty rate was at least .06. </span></span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a><span class="co"># The problem with the following is that because we are including the royalty_rate</span></span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a><span class="co"># in the output we will get some authors more than once since the royalty_rate</span></span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a><span class="co"># may be different for different books that they worked on.</span></span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-31"><a href="#cb101-31" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">" select distinct au_fname, au_lname, royalty_rate</span></span>
<span id="cb101-32"><a href="#cb101-32" aria-hidden="true" tabindex="-1"></a><span class="st">        from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb101-33"><a href="#cb101-33" aria-hidden="true" tabindex="-1"></a><span class="st">                     join titles        on title_authors.title_id = titles.title_id</span></span>
<span id="cb101-34"><a href="#cb101-34" aria-hidden="true" tabindex="-1"></a><span class="st">                     join royalties     on titles.title_id = royalties.title_id</span></span>
<span id="cb101-35"><a href="#cb101-35" aria-hidden="true" tabindex="-1"></a><span class="st">        where royalty_rate &gt; .05</span></span>
<span id="cb101-36"><a href="#cb101-36" aria-hidden="true" tabindex="-1"></a><span class="st">        order by au_lname, au_fname</span></span>
<span id="cb101-37"><a href="#cb101-37" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    au_fname  au_lname royalty_rate
1      Sarah   Buchman         0.06
2      Wendy Heydemark         0.08
3      Wendy Heydemark         0.11
4      Wendy Heydemark         0.09
5     Hallie      Hull         0.08
6     Hallie      Hull         0.07
7       Klee      Hull         0.08
8       Klee      Hull         0.09
9       Klee      Hull         0.11
10      Klee      Hull         0.07
11 Christian     Kells         0.07
12    Harvey   Kellsey         0.07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Final answer</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's now take out the royalty_rate from the select clause. This will serve</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co"># to have every author only be displayed once since the distinct will eliminate</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rows that are duplicates of each other.</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">" select distinct au_fname, au_lname</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="st">        from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="st">                     join titles        on title_authors.title_id = titles.title_id</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="st">                     join royalties     on titles.title_id = royalties.title_id</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="st">        where royalty_rate &gt; .06</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="st">        order by au_lname, au_fname</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_fname  au_lname
1     Wendy Heydemark
2    Hallie      Hull
3      Klee      Hull
4 Christian     Kells
5    Harvey   Kellsey</code></pre>
</div>
</div>
</section>
<section id="reminder-about-how-multiple-joins-work" class="level2" data-number="18.14">
<h2 data-number="18.14" class="anchored" data-anchor-id="reminder-about-how-multiple-joins-work"><span class="header-section-number">18.14</span> Reminder about how multiple joins work</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Reminder about how multiple joins work</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember that every INNER JOIN (which contains an ON clause)</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># is the same as doing a cross join followed by removing the rows from the</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co"># cross join that don't match the on clause of the inner join.</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The condition in the ON clause would work the same way if instead it </span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co"># were part of the WHERE clause.</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Also remember that when you join multiple tables, the first two tables </span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co"># are joined (as described in the previous paragraph). Then the rows and</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="co"># columns that resulted from the first join are joined to the next table in the</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co"># same way (i.e a cross join of rows from the result with the rows from the</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2nd table followed by removing the rows that don't match the corresponding</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="co"># on clause). This keeps happening for all the tables. The entire process</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="co"># happens automatically when you specify the inner joins correctly.</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="co"># For example, if you run the following query, you will get the output shown</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="co"># below.</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   QUERY:</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a><span class="co">#       sqldf(" select distinct au_fname, au_lname</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="co">#               from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                            join titles        on title_authors.title_id = titles.title_id</span></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                            join royalties     on titles.title_id = royalties.title_id</span></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a><span class="co">#               where royalty_rate &gt; .06</span></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a><span class="co">#               order by au_lname, au_fname</span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a><span class="co">#             ")</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   OUTPUT:</span></span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a><span class="co">#           au_fname     au_lname</span></span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a><span class="co">#              Wendy    Heydemark</span></span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a><span class="co">#             Hallie         Hull</span></span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a><span class="co">#               Klee         Hull</span></span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a><span class="co">#          Christian        Kells</span></span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a><span class="co">#             Harvey      Kellsey      </span></span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a><span class="co"># The output looks very short and simple. It has five rows and two columns.</span></span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a><span class="co"># However, in order to arrive at this output, the database must go through</span></span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a><span class="co"># several steps to process the SQL query. At each step of the internal</span></span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a><span class="co"># processing there is an "intermediate result" that you normally would not see. </span></span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Below, we demonstrate step by step what actually happens internally when</span></span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a><span class="co"># the database performs the query. I recommend that you look at</span></span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a><span class="co"># the output of each step to better understand the process:</span></span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st step - </span></span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a><span class="co"># The following part of the "from clause" in the above query is done first:</span></span>
<span id="cb105-54"><a href="#cb105-54" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-55"><a href="#cb105-55" aria-hidden="true" tabindex="-1"></a><span class="co">#    select ...                             (SELECT CLAUSE IS DONE LATER)</span></span>
<span id="cb105-56"><a href="#cb105-56" aria-hidden="true" tabindex="-1"></a><span class="co">#    from authors join title_authors ...    (ON CLAUSE IS DONE LATER)</span></span>
<span id="cb105-57"><a href="#cb105-57" aria-hidden="true" tabindex="-1"></a><span class="co">#                 ...                       (OTHER JOINS ARE DONE LATER)</span></span>
<span id="cb105-58"><a href="#cb105-58" aria-hidden="true" tabindex="-1"></a><span class="co">#    where ...                              (WHERE CLAUSE IS DONE LATER)</span></span>
<span id="cb105-59"><a href="#cb105-59" aria-hidden="true" tabindex="-1"></a><span class="co">#    order by ...                           (ORDER BY CLAUSE IS DONE LATER)</span></span>
<span id="cb105-60"><a href="#cb105-60" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-61"><a href="#cb105-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that this query does an "inner join" (or in other words, a plain</span></span>
<span id="cb105-62"><a href="#cb105-62" aria-hidden="true" tabindex="-1"></a><span class="co"># "join"). However, what actually happens behind the scenes is that these</span></span>
<span id="cb105-63"><a href="#cb105-63" aria-hidden="true" tabindex="-1"></a><span class="co"># two tables are really CROSS JOINED and then the extra rows from the </span></span>
<span id="cb105-64"><a href="#cb105-64" aria-hidden="true" tabindex="-1"></a><span class="co"># "cross join" that don't satisfy the on clause of the inner join are</span></span>
<span id="cb105-65"><a href="#cb105-65" aria-hidden="true" tabindex="-1"></a><span class="co"># removed..</span></span>
<span id="cb105-66"><a href="#cb105-66" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-67"><a href="#cb105-67" aria-hidden="true" tabindex="-1"></a><span class="co"># At this point, the "select clause" has not executed yet so all columns from </span></span>
<span id="cb105-68"><a href="#cb105-68" aria-hidden="true" tabindex="-1"></a><span class="co"># both tables are still part of this intermediate result. In the output </span></span>
<span id="cb105-69"><a href="#cb105-69" aria-hidden="true" tabindex="-1"></a><span class="co"># of the following command every row contains 12 columns. The first 8 columns,</span></span>
<span id="cb105-70"><a href="#cb105-70" aria-hidden="true" tabindex="-1"></a><span class="co"># come from authors table and the last 4 come from the title_authors table.</span></span>
<span id="cb105-71"><a href="#cb105-71" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-72"><a href="#cb105-72" aria-hidden="true" tabindex="-1"></a><span class="co">#   The columns from the authors table are: </span></span>
<span id="cb105-73"><a href="#cb105-73" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-74"><a href="#cb105-74" aria-hidden="true" tabindex="-1"></a><span class="co">#     au_id, au_fname, au_lname, phone, address, city, state, zip</span></span>
<span id="cb105-75"><a href="#cb105-75" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-76"><a href="#cb105-76" aria-hidden="true" tabindex="-1"></a><span class="co">#   and the columns from the title_authors table are:</span></span>
<span id="cb105-77"><a href="#cb105-77" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-78"><a href="#cb105-78" aria-hidden="true" tabindex="-1"></a><span class="co">#     title_id, au_id, au_order, royalty_share</span></span>
<span id="cb105-79"><a href="#cb105-79" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-80"><a href="#cb105-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that in a single row of this intermediate output, the value of the</span></span>
<span id="cb105-81"><a href="#cb105-81" aria-hidden="true" tabindex="-1"></a><span class="co"># au_id from the authors table and the value of the au_id from the title_authors</span></span>
<span id="cb105-82"><a href="#cb105-82" aria-hidden="true" tabindex="-1"></a><span class="co"># table do NOT necessarily match</span></span>
<span id="cb105-83"><a href="#cb105-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-84"><a href="#cb105-84" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select authors.*, title_authors.* </span></span>
<span id="cb105-85"><a href="#cb105-85" aria-hidden="true" tabindex="-1"></a><span class="st">      from authors CROSS JOIN title_authors"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    au_id  au_fname    au_lname        phone              address          city state   zip title_id au_id au_order royalty_shares
1     A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T01   A01        1            1.0
2     A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T02   A01        1            1.0
3     A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T03   A05        1            1.0
4     A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T04   A03        1            0.6
5     A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T04   A04        2            0.4
6     A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T05   A04        1            1.0
7     A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T06   A02        1            1.0
8     A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T07   A02        1            0.5
9     A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T07   A04        2            0.5
10    A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T08   A06        1            1.0
11    A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T09   A06        1            1.0
12    A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T10   A02        1            1.0
13    A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T11   A03        2            0.3
14    A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T11   A04        3            0.3
15    A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T11   A06        1            0.4
16    A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T12   A02        1            1.0
17    A01     Sarah     Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T13   A01        1            1.0
18    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T01   A01        1            1.0
19    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T02   A01        1            1.0
20    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T03   A05        1            1.0
21    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T04   A03        1            0.6
22    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T04   A04        2            0.4
23    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T05   A04        1            1.0
24    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T06   A02        1            1.0
25    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T07   A02        1            0.5
26    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T07   A04        2            0.5
27    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T08   A06        1            1.0
28    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T09   A06        1            1.0
29    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T10   A02        1            1.0
30    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T11   A03        2            0.3
31    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T11   A04        3            0.3
32    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T11   A06        1            0.4
33    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T12   A02        1            1.0
34    A02     Wendy   Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T13   A01        1            1.0
35    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T01   A01        1            1.0
36    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T02   A01        1            1.0
37    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T03   A05        1            1.0
38    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A03        1            0.6
39    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A04        2            0.4
40    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T05   A04        1            1.0
41    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T06   A02        1            1.0
42    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A02        1            0.5
43    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A04        2            0.5
44    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T08   A06        1            1.0
45    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T09   A06        1            1.0
46    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T10   A02        1            1.0
47    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A03        2            0.3
48    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A04        3            0.3
49    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A06        1            0.4
50    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T12   A02        1            1.0
51    A03    Hallie        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T13   A01        1            1.0
52    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T01   A01        1            1.0
53    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T02   A01        1            1.0
54    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T03   A05        1            1.0
55    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A03        1            0.6
56    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A04        2            0.4
57    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T05   A04        1            1.0
58    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T06   A02        1            1.0
59    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A02        1            0.5
60    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A04        2            0.5
61    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T08   A06        1            1.0
62    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T09   A06        1            1.0
63    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T10   A02        1            1.0
64    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A03        2            0.3
65    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A04        3            0.3
66    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A06        1            0.4
67    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T12   A02        1            1.0
68    A04      Klee        Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T13   A01        1            1.0
69    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T01   A01        1            1.0
70    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T02   A01        1            1.0
71    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T03   A05        1            1.0
72    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T04   A03        1            0.6
73    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T04   A04        2            0.4
74    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T05   A04        1            1.0
75    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T06   A02        1            1.0
76    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T07   A02        1            0.5
77    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T07   A04        2            0.5
78    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T08   A06        1            1.0
79    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T09   A06        1            1.0
80    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T10   A02        1            1.0
81    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T11   A03        2            0.3
82    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T11   A04        3            0.3
83    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T11   A06        1            0.4
84    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T12   A02        1            1.0
85    A05 Christian       Kells 212-771-4680       114 Horatio St      New York    NY 10014      T13   A01        1            1.0
86    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T01   A01        1            1.0
87    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T02   A01        1            1.0
88    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T03   A05        1            1.0
89    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T04   A03        1            0.6
90    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T04   A04        2            0.4
91    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T05   A04        1            1.0
92    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T06   A02        1            1.0
93    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T07   A02        1            0.5
94    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T07   A04        2            0.5
95    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T08   A06        1            1.0
96    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T09   A06        1            1.0
97    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T10   A02        1            1.0
98    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A03        2            0.3
99    A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A04        3            0.3
100   A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A06        1            0.4
101   A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T12   A02        1            1.0
102   A06    Harvey     Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T13   A01        1            1.0
103   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T01   A01        1            1.0
104   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T02   A01        1            1.0
105   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T03   A05        1            1.0
106   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T04   A03        1            0.6
107   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T04   A04        2            0.4
108   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T05   A04        1            1.0
109   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T06   A02        1            1.0
110   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T07   A02        1            0.5
111   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T07   A04        2            0.5
112   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T08   A06        1            1.0
113   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T09   A06        1            1.0
114   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T10   A02        1            1.0
115   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T11   A03        2            0.3
116   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T11   A04        3            0.3
117   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T11   A06        1            0.4
118   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T12   A02        1            1.0
119   A07     Paddy O'Furniture 941-925-0752         1442 Main St      Sarasota    FL 34236      T13   A01        1            1.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2nd step - </span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The on clause is applied to the results from the previous step 1 to eliminate</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># those rows from the cross join that don't match the on clause specified</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co"># in the query. Notice that in the results of the following command the </span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="co"># first au_id and the second au_id </span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select authors.*, title_authors.*</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="st">      from authors join title_authors on authors.au_id = title_authors.au_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_id  au_fname  au_lname        phone              address          city state   zip title_id au_id au_order royalty_shares
1    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T01   A01        1            1.0
2    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T02   A01        1            1.0
3    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T13   A01        1            1.0
4    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T06   A02        1            1.0
5    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T07   A02        1            0.5
6    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T10   A02        1            1.0
7    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T12   A02        1            1.0
8    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A03        1            0.6
9    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A03        2            0.3
10   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A04        2            0.4
11   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T05   A04        1            1.0
12   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A04        2            0.5
13   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A04        3            0.3
14   A05 Christian     Kells 212-771-4680       114 Horatio St      New York    NY 10014      T03   A05        1            1.0
15   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T08   A06        1            1.0
16   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T09   A06        1            1.0
17   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A06        1            0.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3rd step - </span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select authors.*, title_authors.*, titles.*</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="st">      from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="st">                   join titles        on title_authors.title_id = titles.title_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_id  au_fname  au_lname        phone              address          city state   zip title_id au_id au_order royalty_shares title_id                          title_name       type pub_id pages price   sales         pubdate
1    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T01   A01        1            1.0      T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00
2    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T02   A01        1            1.0      T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00
3    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T13   A01        1            1.0      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00
4    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T06   A02        1            1.0      T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00
5    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T07   A02        1            0.5      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00
6    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T10   A02        1            1.0      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;
7    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T12   A02        1            1.0      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00
8    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A03        1            0.6      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00
9    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A03        2            0.3      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00
10   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A04        2            0.4      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00
11   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T05   A04        1            1.0      T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00
12   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A04        2            0.5      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00
13   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A04        3            0.3      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00
14   A05 Christian     Kells 212-771-4680       114 Horatio St      New York    NY 10014      T03   A05        1            1.0      T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00
15   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T08   A06        1            1.0      T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00
16   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T09   A06        1            1.0      T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00
17   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A06        1            0.4      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4th step - join royalties on titles.title_id = royalties.title_id</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select authors.*, title_authors.*, titles.*, royalties.*</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="st">      from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="st">                   join titles        on title_authors.title_id = titles.title_id</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="st">                   join royalties     on titles.title_id = royalties.title_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_id  au_fname  au_lname        phone              address          city state   zip title_id au_id au_order royalty_shares title_id                          title_name       type pub_id pages price   sales         pubdate title_id advance royalty_rate
1    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T01   A01        1            1.0      T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00      T01   10000         0.05
2    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T02   A01        1            1.0      T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00      T02    1000         0.06
3    A01     Sarah   Buchman 718-496-7223       75 West 205 St         Bronx    NY 10468      T13   A01        1            1.0      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00      T13   20000         0.06
4    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T06   A02        1            1.0      T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00      T06   20000         0.08
5    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T07   A02        1            0.5      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00      T07 1000000         0.11
6    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T10   A02        1            1.0      T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;      T10      NA           NA
7    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T12   A02        1            1.0      T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00      T12   50000         0.09
8    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A03        1            0.6      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00      T04   20000         0.08
9    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A03        2            0.3      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00      T11  100000         0.07
10   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A04        2            0.4      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00      T04   20000         0.08
11   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T05   A04        1            1.0      T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00      T05  100000         0.09
12   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A04        2            0.5      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00      T07 1000000         0.11
13   A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A04        3            0.3      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00      T11  100000         0.07
14   A05 Christian     Kells 212-771-4680       114 Horatio St      New York    NY 10014      T03   A05        1            1.0      T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00      T03   15000         0.07
15   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T08   A06        1            1.0      T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00      T08       0         0.04
16   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T09   A06        1            1.0      T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00      T09       0         0.05
17   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A06        1            0.4      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00      T11  100000         0.07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5th step - where</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select authors.*, title_authors.*, titles.*, royalties.*</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="st">               from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="st">                            join titles        on title_authors.title_id = titles.title_id</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="st">                            join royalties     on titles.title_id = royalties.title_id</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="st">               where royalty_rate &gt; .06</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="st">             "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_id  au_fname  au_lname        phone              address          city state   zip title_id au_id au_order royalty_shares title_id                       title_name       type pub_id pages price   sales         pubdate title_id advance royalty_rate
1    A05 Christian     Kells 212-771-4680       114 Horatio St      New York    NY 10014      T03   A05        1            1.0      T03     Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00      T03   15000         0.07
2    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A03        1            0.6      T04        But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00      T04   20000         0.08
3    A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A04        2            0.4      T04        But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00      T04   20000         0.08
4    A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T05   A04        1            1.0      T05           Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00      T05  100000         0.09
5    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T06   A02        1            1.0      T06                 How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00      T06   20000         0.08
6    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T07   A02        1            0.5      T07                I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00      T07 1000000         0.11
7    A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A04        2            0.5      T07                I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00      T07 1000000         0.11
8    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A03        2            0.3      T11 Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00      T11  100000         0.07
9    A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A04        3            0.3      T11 Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00      T11  100000         0.07
10   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A06        1            0.4      T11 Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00      T11  100000         0.07
11   A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T12   A02        1            1.0      T12        Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00      T12   50000         0.09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6th step - order by </span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select authors.*, title_authors.*, titles.*, royalties.*</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="st">               from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="st">                            join titles        on title_authors.title_id = titles.title_id</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="st">                            join royalties     on titles.title_id = royalties.title_id</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="st">               where royalty_rate &gt; .06</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="st">               order by au_lname, au_fname</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="st">             "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_id  au_fname  au_lname        phone              address          city state   zip title_id au_id au_order royalty_shares title_id                       title_name       type pub_id pages price   sales         pubdate title_id advance royalty_rate
1    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T06   A02        1            1.0      T06                 How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00      T06   20000         0.08
2    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T07   A02        1            0.5      T07                I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00      T07 1000000         0.11
3    A02     Wendy Heydemark 303-986-7020     2922 Baseline Rd       Boulder    CO 80303      T12   A02        1            1.0      T12        Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00      T12   50000         0.09
4    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A03        1            0.6      T04        But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00      T04   20000         0.08
5    A03    Hallie      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A03        2            0.3      T11 Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00      T11  100000         0.07
6    A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T04   A04        2            0.4      T04        But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00      T04   20000         0.08
7    A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T05   A04        1            1.0      T05           Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00      T05  100000         0.09
8    A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T07   A04        2            0.5      T07                I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00      T07 1000000         0.11
9    A04      Klee      Hull 415-549-4278 3800 Waldo Ave, #14F San Francisco    CA 94123      T11   A04        3            0.3      T11 Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00      T11  100000         0.07
10   A05 Christian     Kells 212-771-4680       114 Horatio St      New York    NY 10014      T03   A05        1            1.0      T03     Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00      T03   15000         0.07
11   A06    Harvey   Kellsey 650-836-7128       390 Serra Mall     Palo Alto    CA 94305      T11   A06        1            0.4      T11 Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00      T11  100000         0.07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7th step - select</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select au_fname, au_lname</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="st">               from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="st">                            join titles        on title_authors.title_id = titles.title_id</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="st">                            join royalties     on titles.title_id = royalties.title_id</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="st">               where royalty_rate &gt; .06</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="st">               order by au_lname, au_fname</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="st">             "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    au_fname  au_lname
1      Wendy Heydemark
2      Wendy Heydemark
3      Wendy Heydemark
4     Hallie      Hull
5     Hallie      Hull
6       Klee      Hull
7       Klee      Hull
8       Klee      Hull
9       Klee      Hull
10 Christian     Kells
11    Harvey   Kellsey</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6th step - select distinct</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select DISTINCT au_fname, au_lname</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="st">               from authors join title_authors on authors.au_id = title_authors.au_id</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="st">                            join titles        on title_authors.title_id = titles.title_id</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="st">                            join royalties     on titles.title_id = royalties.title_id</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="st">               where royalty_rate &gt; .06</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="st">               order by au_lname, au_fname</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="st">             "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   au_fname  au_lname
1     Wendy Heydemark
2    Hallie      Hull
3      Klee      Hull
4 Christian     Kells
5    Harvey   Kellsey</code></pre>
</div>
</div>
</section>
<section id="warning---if-where-clause-removes-all-rows-then-avgsummaxmin-return-null" class="level2" data-number="18.15">
<h2 data-number="18.15" class="anchored" data-anchor-id="warning---if-where-clause-removes-all-rows-then-avgsummaxmin-return-null"><span class="header-section-number">18.15</span> WARNING - If where clause removes all rows then avg,sum,max,min return NULL</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co"> : If no rows are returned by the where clause, then the </span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="co">#           aggregate functions (except for count) all return NULL</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="co">#           Note that since we are using R dataframes instead</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a><span class="co">#           of tables, NULL will be displayed as NA</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="co"># No rows match the where - result of all aggregate functions, except count </span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="co"># is NULL (i.e. NA in R)</span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select count(*), sum(pages), avg(pages), min(pages), max(pages)</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="st">      where type = 'this type does not exist' "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  count(*) sum(pages) avg(pages) min(pages) max(pages)
1        0         NA         NA         NA         NA</code></pre>
</div>
</div>
</section>
<section id="practice-2" class="level2" data-number="18.16">
<h2 data-number="18.16" class="anchored" data-anchor-id="practice-2"><span class="header-section-number">18.16</span> Practice</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co"># show the total number of cookbooks (i.e. type = 'cookbook')</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co">#          total number of pages in all the cookbooks</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co">#          and the average number of pages in cookbooks</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co"> that since there are currently no cookbooks in the table</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co"># there will be no rows returned by the where clause. Therefore</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="co"># the sum and the avg will be NULL (i.e. NA in R)</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select count(*), sum(pages), avg(pages)</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a><span class="st">      where type = 'cookbook'"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  count(*) sum(pages) avg(pages)
1        0         NA         NA</code></pre>
</div>
</div>
</section>
<section id="dont-use-aggregate-functions-non-aggregated-values-in-same-select-clause" class="level2" data-number="18.17">
<h2 data-number="18.17" class="anchored" data-anchor-id="dont-use-aggregate-functions-non-aggregated-values-in-same-select-clause"><span class="header-section-number">18.17</span> DON’T use aggregate functions &amp; non-aggregated values in same select clause</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################################</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co"> : </span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="co"># DO NOT include both aggregate function and non-aggregated values</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="co"># in the same select clause</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="co">#    (</span><span class="al">NOTE</span><span class="co"> - it may help to look at the example below before reading further)</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="co"># BECAUSE ...    </span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="co"># The aggregate function will return fewer rows than the </span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="co"># non-aggregated data. This presents a problem for SQL because</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="co"># there is a contradiction as to how many rows should be shown!</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="co"># In many many versions of SQL, such queries would generate an ERROR!</span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a><span class="co"># In SQLite, this query doesn't generate an error. Rather, the query </span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a><span class="co"># will only return one row. The values of the non-aggregate column</span></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="co"># will be the first value that would have appeared for that non-aggregate</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a><span class="co"># column if the aggregate function was not present.</span></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a><span class="co"># See this page for an in-depth analysis of this issue: </span></span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   https://www.dataquest.io/blog/sql-tutorial-selecting-ungrouped-columns-without-aggregate-functions/</span></span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################################</span></span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a><span class="co"># The output of the following produces ONE row</span></span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select avg(price) from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  avg(price)
1    18.3875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The output of the following produces MORE THAN ONE row</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select title_name from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            title_name
1                                1977!
2            200 Years of German Humor
3         Ask Yor System Administrator
4            But I Did It Unconciously
5               Exchange of Platitudes
6                     How About Never?
7                    I Blame My Mother
8         Just Wait Until After School
9                      Kiss My Boo Boo
10         Not Without My Fabrerge Egg
11    Perhaps It's a Glandular Problem
12           Spontaneous, Not Annoying
13 What Are The Civilian Applications?</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following will generate an ERROR in MANY MANY versions of SQL.</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co"># since avg(price) should return ONE number, but there are many different</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co"># values for title_name.</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="co"># SQLite allows this type of query but the results are confusing.</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Since the avg generates only a single number, the following results in</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co"># only a single row with only one particular title even though there are</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="co"># many different title_names.</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co"># DON'T DO THIS!!! (see the comment above)</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select avg(price) , title_name from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  avg(price) title_name
1    18.3875      1977!</code></pre>
</div>
</div>
</section>
<section id="order-of-clauses-select-from-where-group-by-having-order-by-limit" class="level2" data-number="18.18">
<h2 data-number="18.18" class="anchored" data-anchor-id="order-of-clauses-select-from-where-group-by-having-order-by-limit"><span class="header-section-number">18.18</span> ORDER OF CLAUSES: select, from, where, group by, having, order by, limit</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># REMEMBER</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co">#    While select statements don't always need to use every clause, </span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    the clauses that are in a statement must appear in the following order:</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="co"># select ...</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="co"># from ...</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co"># where ...</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="co"># group by ...</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="co"># having ...</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="co"># order by ...</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="co"># limit ... </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="group-by-affects-how-aggregate-functions-work" class="level2" data-number="18.19">
<h2 data-number="18.19" class="anchored" data-anchor-id="group-by-affects-how-aggregate-functions-work"><span class="header-section-number">18.19</span> GROUP BY affects how aggregate functions work</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################################</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="co"># group by COLUMN1, COLUMN2, ...</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The "group by" clause has a direct effect on how aggregate functions work.</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="co"># As we've seen above, when a query contains an</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate function </span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   (and does not contain a group by clause -</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="co">#    remember we didn't start discussing "group by" until just now),</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="co"># the query will return a single row. The single row</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="co"># of output would contain the result of applying the aggregate function(s)</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="co"># to all of the rows from the table that satisfied the where clause.</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co"># By contrast, a query that contains aggregate functions, and also contains</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="co"># a group by clause, could return more than one row of output, i.e. one row of</span></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="co"># output for each "group" of rows from the original table(s) [... keep reading ...] </span></span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="co"># The group by clause specifies one or more columns. The rows from the table(s)</span></span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a><span class="co"># that contain the same values for these columns constitute a logical "group" of</span></span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="co"># rows. For example the following shows the format of a query that gets info</span></span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a><span class="co"># from the titles table. A lot of the query was left out because for now </span></span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a><span class="co"># I want to focus just on "from titles" and "group by type"</span></span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     select ... (specify what you want to select)</span></span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     from titles</span></span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     ... (more stuff from the qeury)</span></span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     group by type</span></span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a><span class="co"># This query segments the rows from the titles table into</span></span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a><span class="co"># different "groups". </span></span>
<span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   There will be one     "group" that contains all rows with type='biography'.</span></span>
<span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   There will be another "group" that contains all rows with type='childrens'.</span></span>
<span id="cb132-33"><a href="#cb132-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   There will be another "group" that contains all rows with type='computer'.</span></span>
<span id="cb132-34"><a href="#cb132-34" aria-hidden="true" tabindex="-1"></a><span class="co">#   etc. </span></span>
<span id="cb132-35"><a href="#cb132-35" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb132-36"><a href="#cb132-36" aria-hidden="true" tabindex="-1"></a><span class="co"># If the query were to include aggregate functions, the output would indlude</span></span>
<span id="cb132-37"><a href="#cb132-37" aria-hidden="true" tabindex="-1"></a><span class="co"># one row for each "group" of rows from the original table. This is </span></span>
<span id="cb132-38"><a href="#cb132-38" aria-hidden="true" tabindex="-1"></a><span class="co"># best explained with an example:</span></span>
<span id="cb132-39"><a href="#cb132-39" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="practice-3" class="level2" data-number="18.20">
<h2 data-number="18.20" class="anchored" data-anchor-id="practice-3"><span class="header-section-number">18.20</span> Practice</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First let's look at all of the types and prices in order</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, price </span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles </span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="st">      order by type, price"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         type price
1   biography    NA
2   biography 12.99
3   biography 19.95
4   biography 23.95
5    children 10.00
6    children 13.95
7    computer 39.95
8     history 19.95
9     history 21.99
10    history 29.99
11 psychology  6.95
12 psychology  7.99
13 psychology 12.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Write a query that returns the following for each </span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="co"># type of book (i.e. "childrens", "computer", etc)</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     the number of copies of each type </span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     the average price of all books of that type</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     the max price of all books of that type</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     the min price of all books of that type</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a><span class="co"># HINT: use group by to create different groups of rows from the original table</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="co">#       All the rows with the same value for type will be part of the same group.</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a><span class="co">#       Then use the avg(price) function to get the average price for each type.</span></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, count(*), avg(price), max(price), min(price)</span></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type</span></span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a><span class="st">      order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type count(*) avg(price) max(price) min(price)
1  biography        4   18.96333      23.95      12.99
2   children        2   11.97500      13.95      10.00
3   computer        1   39.95000      39.95      39.95
4    history        3   23.97667      29.99      19.95
5 psychology        3    9.31000      12.99       6.95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To make the output easier to read, change the code to display "#copies"</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co"># instead of count(*) at the top of that column in the output.</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, count(*) as '#copies', avg(price), max(price), min(price)</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="st">      order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type #copies avg(price) max(price) min(price)
1  biography       4   18.96333      23.95      12.99
2   children       2   11.97500      13.95      10.00
3   computer       1   39.95000      39.95      39.95
4    history       3   23.97667      29.99      19.95
5 psychology       3    9.31000      12.99       6.95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select count(*) as '#copies', avg(price), max(price), min(price)</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  #copies avg(price) max(price) min(price)
1      13    18.3875      39.95       6.95</code></pre>
</div>
</div>
</section>
<section id="group-by-more-than-one-column" class="level2" data-number="18.21">
<h2 data-number="18.21" class="anchored" data-anchor-id="group-by-more-than-one-column"><span class="header-section-number">18.21</span> GROUP BY more than one column</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GROUP BY more than one column</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The GROUP BY may contain more than one column. </span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This in effect creates a group from all rows that have the same value</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for all of the specified columns.</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="co"># First let's look at the types, pub_id's, titles and prices of all books in order</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, pub_id, price, title_name</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="st">       order by type, pub_id, price"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         type pub_id price                          title_name
1   biography    P01 19.95                    How About Never?
2   biography    P03 23.95                   I Blame My Mother
3   biography    P05    NA         Not Without My Fabrerge Egg
4   biography    P05 12.99           Spontaneous, Not Annoying
5    children    P01 10.00        Just Wait Until After School
6    children    P01 13.95                     Kiss My Boo Boo
7    computer    P02 39.95        Ask Yor System Administrator
8     history    P01 21.99                               1977!
9     history    P03 19.95           200 Years of German Humor
10    history    P03 29.99 What Are The Civilian Applications?
11 psychology    P01  6.95              Exchange of Platitudes
12 psychology    P01 12.99           But I Did It Unconciously
13 psychology    P05  7.99    Perhaps It's a Glandular Problem</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let's create groups and show how many titles in each group.</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, pub_id, count(*)</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="st">       group by type, pub_id</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="st">       order by type, pub_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type pub_id count(*)
1  biography    P01        1
2  biography    P03        1
3  biography    P05        2
4   children    P01        2
5   computer    P02        1
6    history    P01        1
7    history    P03        2
8 psychology    P01        2
9 psychology    P05        1</code></pre>
</div>
</div>
</section>
<section id="practice-4" class="level2" data-number="18.22">
<h2 data-number="18.22" class="anchored" data-anchor-id="practice-4"><span class="header-section-number">18.22</span> Practice</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Write a query that returns the average price, max price and min price of each</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="co"># type of book (i.e. "childrens", "computer", etc) that is published by each </span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="co"># publisher.</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPORTANT - REMEMBER ... </span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Clauses in a SELECT statement must appear in the following order:</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="co"># All of the clauses are optional except for the "select" clause.</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   select ...</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   from ...</span></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   where ...</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   group by  ...</span></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   having ...</span></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   order by ...</span></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   limit ...       (limit is not part of the SQL standard but is part of many versions of SQL)</span></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a><span class="co"># ANSWER</span></span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a><span class="co"># In the output of the following command, note that only one row is</span></span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a><span class="co"># shown for each type/pub_id combination</span></span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, pub_id, count(*) as '#copies', avg(price), min(price), max(price)</span></span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type, pub_id</span></span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a><span class="st">      order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type pub_id #copies avg(price) min(price) max(price)
1  biography    P01       1     19.950      19.95      19.95
2  biography    P03       1     23.950      23.95      23.95
3  biography    P05       2     12.990      12.99      12.99
4   children    P01       2     11.975      10.00      13.95
5   computer    P02       1     39.950      39.95      39.95
6    history    P01       1     21.990      21.99      21.99
7    history    P03       2     24.970      19.95      29.99
8 psychology    P01       2      9.970       6.95      12.99
9 psychology    P05       1      7.990       7.99       7.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rewrite the order by of the previous query so that all books by the same publisher</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="co"># appear together in consecutive rows (i.e. rows that are "one after the other" for </span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the same publisher)</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Note it makes no difference which column is listed first in the group by </span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="co">#      it DOES make a difference which column is listed first in the order by</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ANSWER</span></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, pub_id, avg(price), count(*), min(price), max(price), sum(price)</span></span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type, pub_id   </span></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="st">      order by pub_id, type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type pub_id avg(price) count(*) min(price) max(price) sum(price)
1  biography    P01     19.950        1      19.95      19.95      19.95
2   children    P01     11.975        2      10.00      13.95      23.95
3    history    P01     21.990        1      21.99      21.99      21.99
4 psychology    P01      9.970        2       6.95      12.99      19.94
5   computer    P02     39.950        1      39.95      39.95      39.95
6  biography    P03     23.950        1      23.95      23.95      23.95
7    history    P03     24.970        2      19.95      29.99      49.94
8  biography    P05     12.990        2      12.99      12.99      12.99
9 psychology    P05      7.990        1       7.99       7.99       7.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the order of the pub_id and the type in the select so that the output is easier to read.</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select pub_id, type, avg(price), count(*), min(price), max(price), sum(price)</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type, pub_id</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="st">      order by pub_id, type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pub_id       type avg(price) count(*) min(price) max(price) sum(price)
1    P01  biography     19.950        1      19.95      19.95      19.95
2    P01   children     11.975        2      10.00      13.95      23.95
3    P01    history     21.990        1      21.99      21.99      21.99
4    P01 psychology      9.970        2       6.95      12.99      19.94
5    P02   computer     39.950        1      39.95      39.95      39.95
6    P03  biography     23.950        1      23.95      23.95      23.95
7    P03    history     24.970        2      19.95      29.99      49.94
8    P05  biography     12.990        2      12.99      12.99      12.99
9    P05 psychology      7.990        1       7.99       7.99       7.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co"> - THE FOLLOWING QUERY IS WRONG SINCE title_name IS NOT AN AGGREGATE</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co"># FUNCTION AND IS ALSO NOT IN THE GROUP BY CLAUSE.</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="co"># SOME Database Management Systems (DBMS) WILL RETURN AN ERROR FOR THE </span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="co"># FOLLOWING QUERY, WHEREAS SQLITE, the database that R sqldf uses by default,</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="co"># DOESN'T REUTRN AN ERROR BUT RATHER RETURNS CONFUSING RESULTS. -- DON'T DO THIS!</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select pub_id, type, title_name, avg(price), count(*), min(price), max(price), sum(price)</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type, pub_id</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="st">      order by pub_id, type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pub_id       type                          title_name avg(price) count(*) min(price) max(price) sum(price)
1    P01  biography                    How About Never?     19.950        1      19.95      19.95      19.95
2    P01   children                     Kiss My Boo Boo     11.975        2      10.00      13.95      23.95
3    P01    history                               1977!     21.990        1      21.99      21.99      21.99
4    P01 psychology           But I Did It Unconciously      9.970        2       6.95      12.99      19.94
5    P02   computer        Ask Yor System Administrator     39.950        1      39.95      39.95      39.95
6    P03  biography                   I Blame My Mother     23.950        1      23.95      23.95      23.95
7    P03    history What Are The Civilian Applications?     24.970        2      19.95      29.99      49.94
8    P05  biography           Spontaneous, Not Annoying     12.990        2      12.99      12.99      12.99
9    P05 psychology    Perhaps It's a Glandular Problem      7.990        1       7.99       7.99       7.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="co"># QUESTION</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rewrite the previous query to show the publisher's name instead of the publisher's id</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a><span class="co"># HINTS</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - you must join the appropriate tables</span></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="co"># - since the query has a group by, the select clause should only refer to </span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   aggregate functions and to columns that appear in the group by.</span></span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   The select clause should NOT refer to columns that do not appear in the group by.</span></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   Since we want to display the publisher's name we should also group by </span></span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   the publisher's name instead of the pub_id.</span></span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span><span class="al">NOTE</span><span class="co"> - that this is reasonable to do since for all rows with the same</span></span>
<span id="cb153-17"><a href="#cb153-17" aria-hidden="true" tabindex="-1"></a><span class="co">#          pub_id, the publisher's name is guaranteed to be the same </span></span>
<span id="cb153-18"><a href="#cb153-18" aria-hidden="true" tabindex="-1"></a><span class="co">#          (think about it)</span></span>
<span id="cb153-19"><a href="#cb153-19" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb153-20"><a href="#cb153-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-21"><a href="#cb153-21" aria-hidden="true" tabindex="-1"></a><span class="co"># show one row for each title.</span></span>
<span id="cb153-22"><a href="#cb153-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb153-23"><a href="#cb153-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the info from the title table and the associated info</span></span>
<span id="cb153-24"><a href="#cb153-24" aria-hidden="true" tabindex="-1"></a><span class="co"># from the publisher's table in the single row of output for each title.</span></span>
<span id="cb153-25"><a href="#cb153-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-26"><a href="#cb153-26" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select titles.*, publishers.*</span></span>
<span id="cb153-27"><a href="#cb153-27" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles join publishers on titles.pub_id = publishers.pub_id</span></span>
<span id="cb153-28"><a href="#cb153-28" aria-hidden="true" tabindex="-1"></a><span class="st">      order by pub_name, type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name       type pub_id pages price   sales         pubdate pub_id             pub_name          city state country
1       T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;    P05       AAA Publishing      Berkeley    CA     USA
2       T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
3       T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00    P05       AAA Publishing      Berkeley    CA     USA
4       T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00    P01    Abatis Publishers      New York    NY     USA
5       T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00    P01    Abatis Publishers      New York    NY     USA
6       T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00    P01    Abatis Publishers      New York    NY     USA
7       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00    P01    Abatis Publishers      New York    NY     USA
8       T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00    P01    Abatis Publishers      New York    NY     USA
9       T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00    P01    Abatis Publishers      New York    NY     USA
10      T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00    P02      Core Dump Books San Francisco    CA     USA
11      T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
12      T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany
13      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00    P03 Schandenfreude Press       Hamburg  &lt;NA&gt; Germany</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the pub_name in the output (not just the pub_id)</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="co"># along with aggregate info for that publisher and type of book.</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co"># In ANSI standard SQL and in most DBMS software (e.g. oracle, MySql, Postgres)</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to include pub_name in the group by if we will include it in the </span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="co"># output. </span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select pub_name, type, avg(price), count(*), min(price), max(price), sum(price)</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles join publishers on titles.pub_id = publishers.pub_id</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type, pub_name</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a><span class="st">      order by pub_name, type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              pub_name       type avg(price) count(*) min(price) max(price) sum(price)
1       AAA Publishing  biography     12.990        2      12.99      12.99      12.99
2       AAA Publishing psychology      7.990        1       7.99       7.99       7.99
3    Abatis Publishers  biography     19.950        1      19.95      19.95      19.95
4    Abatis Publishers   children     11.975        2      10.00      13.95      23.95
5    Abatis Publishers    history     21.990        1      21.99      21.99      21.99
6    Abatis Publishers psychology      9.970        2       6.95      12.99      19.94
7      Core Dump Books   computer     39.950        1      39.95      39.95      39.95
8 Schandenfreude Press  biography     23.950        1      23.95      23.95      23.95
9 Schandenfreude Press    history     24.970        2      19.95      29.99      49.94</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SQLite will allow the pub_name in the select clause even if it isn't</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in the group by. However, you should avoid this - it isn't standard ANSI SQL.</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select pub_name, type, avg(price), count(*), min(price), max(price), sum(price)</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles join publishers on titles.pub_id = publishers.pub_id</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type, publishers.pub_id</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="st">      order by pub_name, type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              pub_name       type avg(price) count(*) min(price) max(price) sum(price)
1       AAA Publishing  biography     12.990        2      12.99      12.99      12.99
2       AAA Publishing psychology      7.990        1       7.99       7.99       7.99
3    Abatis Publishers  biography     19.950        1      19.95      19.95      19.95
4    Abatis Publishers   children     11.975        2      10.00      13.95      23.95
5    Abatis Publishers    history     21.990        1      21.99      21.99      21.99
6    Abatis Publishers psychology      9.970        2       6.95      12.99      19.94
7      Core Dump Books   computer     39.950        1      39.95      39.95      39.95
8 Schandenfreude Press  biography     23.950        1      23.95      23.95      23.95
9 Schandenfreude Press    history     24.970        2      19.95      29.99      49.94</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rewrite the previous query to only group by the pub_name and not by the type.</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co"># HINTS - because the type is not part of the group by it should also be eliminated</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="co">#         from the select clause and the order by clause</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select pub_name, avg(price), count(*), min(price), max(price), sum(price)</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles join publishers on titles.pub_id = publishers.pub_id</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="st">      group by pub_name</span></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="st">      order by pub_name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              pub_name avg(price) count(*) min(price) max(price) sum(price)
1       AAA Publishing     10.490        3       7.99      12.99      20.98
2    Abatis Publishers     14.305        6       6.95      21.99      85.83
3      Core Dump Books     39.950        1      39.95      39.95      39.95
4 Schandenfreude Press     24.630        3      19.95      29.99      73.89</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co">#``````````````````````````````````````````````````````````````````````````````</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="co"># SQLite doesn't follow the standard exactly ..</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="co">#``````````````````````````````````````````````````````````````````````````````</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that the SQL standard does not allow for column names in the select and order by </span></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="co"># clauses that are not also part of the group by.</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="co"># However, SQLite, does not report an error in these cases and the output could be</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="co"># confusing. The following output shows a type, but the avg and other aggregate functions</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="co"># include ALL types, not just the one shown.</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="co"># See these page for a description of the issue and suggestions for workarounds:</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   https://www.dataquest.io/blog/sql-tutorial-selecting-ungrouped-columns-without-aggregate-functions/</span></span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   https://learnsql.com/blog/not-a-group-by-expression-error/</span></span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a><span class="co"># See this page for the official SQLite documentation </span></span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Below is an excerpt of the relevant info from this page.</span></span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   https://www.sqlite.org/lang_select.html#bareagg</span></span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2.5. Bare columns in an aggregate query The usual case is that all column</span></span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># names in an aggregate query are either arguments to aggregate functions or</span></span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># else appear in the GROUP BY clause. A result column which contains a column</span></span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># name that is not within an aggregate function and that does not appear in the</span></span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># GROUP BY clause (if one exists) is called a "bare" column. Example:</span></span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">#</span></span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># SELECT a, b, sum(c) FROM tab1 GROUP BY a; In the query above, the "a" column</span></span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># is part of the GROUP BY clause and so each row of the output contains one of</span></span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the distinct values for "a". The "c" column is contained within the sum()</span></span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># aggregate function and so that output column is the sum of all "c" values in</span></span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># rows that have the same value for "a". But what is the result of the bare</span></span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># column "b"? The answer is that the "b" result will be the value for "b" in one</span></span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># of the input rows that form the aggregate. The problem is that you usually do</span></span>
<span id="cb161-36"><a href="#cb161-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># not know which input row is used to compute "b", and so in many cases the</span></span>
<span id="cb161-37"><a href="#cb161-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># value for "b" is undefined.</span></span>
<span id="cb161-38"><a href="#cb161-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">#</span></span>
<span id="cb161-39"><a href="#cb161-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Special processing occurs when the aggregate function is either min() or</span></span>
<span id="cb161-40"><a href="#cb161-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># max(). Example:</span></span>
<span id="cb161-41"><a href="#cb161-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">#</span></span>
<span id="cb161-42"><a href="#cb161-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># SELECT a, b, max(c) FROM tab1 GROUP BY a; If there is exactly one min() or</span></span>
<span id="cb161-43"><a href="#cb161-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># max() aggregate in the query, then all bare columns in the result set take</span></span>
<span id="cb161-44"><a href="#cb161-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># values from an input row which also contains the minimum or maximum. So in the</span></span>
<span id="cb161-45"><a href="#cb161-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># query above, the value of the "b" column in the output will be the value of</span></span>
<span id="cb161-46"><a href="#cb161-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the "b" column in the input row that has the largest "c" value. There are</span></span>
<span id="cb161-47"><a href="#cb161-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># limitations on this special behavior of min() and max():</span></span>
<span id="cb161-48"><a href="#cb161-48" aria-hidden="true" tabindex="-1"></a>        <span class="co">#</span></span>
<span id="cb161-49"><a href="#cb161-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If the same minimum or maximum value occurs on two or more rows, then bare</span></span>
<span id="cb161-50"><a href="#cb161-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># values might be selected from any of those rows. The choice is arbitrary.</span></span>
<span id="cb161-51"><a href="#cb161-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># There is no way to predict from which row the bare values will be choosen. The</span></span>
<span id="cb161-52"><a href="#cb161-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># choice might be different for different bare columns within the same query.</span></span>
<span id="cb161-53"><a href="#cb161-53" aria-hidden="true" tabindex="-1"></a>        <span class="co">#</span></span>
<span id="cb161-54"><a href="#cb161-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If there are two or more min() or max() aggregates in the query, then bare</span></span>
<span id="cb161-55"><a href="#cb161-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># column values will be taken from one of the rows on which one of the</span></span>
<span id="cb161-56"><a href="#cb161-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># aggregates has their minimum or maximum value. The choice of which min() or</span></span>
<span id="cb161-57"><a href="#cb161-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># max() aggregate determines the selection of bare column values is arbitrary.</span></span>
<span id="cb161-58"><a href="#cb161-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># The choice might be different for different bare columns within the same</span></span>
<span id="cb161-59"><a href="#cb161-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># query.</span></span>
<span id="cb161-60"><a href="#cb161-60" aria-hidden="true" tabindex="-1"></a>        <span class="co">#</span></span>
<span id="cb161-61"><a href="#cb161-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This special processing for min() or max() aggregates only works for the</span></span>
<span id="cb161-62"><a href="#cb161-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># built-in implementation of those aggregates. If an application overrides the</span></span>
<span id="cb161-63"><a href="#cb161-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># built-in min() or max() aggregates with application-defined alternatives, then</span></span>
<span id="cb161-64"><a href="#cb161-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the values selected for bare columns will be taken from an arbitrary row.</span></span>
<span id="cb161-65"><a href="#cb161-65" aria-hidden="true" tabindex="-1"></a>        <span class="co">#</span></span>
<span id="cb161-66"><a href="#cb161-66" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Most other SQL database engines disallow bare columns. If you include a bare</span></span>
<span id="cb161-67"><a href="#cb161-67" aria-hidden="true" tabindex="-1"></a>        <span class="co"># column in a query, other database engines will usually raise an error. The</span></span>
<span id="cb161-68"><a href="#cb161-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ability to include bare columns in a query is an SQLite-specific extension.</span></span>
<span id="cb161-69"><a href="#cb161-69" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb161-70"><a href="#cb161-70" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb161-71"><a href="#cb161-71" aria-hidden="true" tabindex="-1"></a><span class="co">#``````````````````````````````````````````````````````````````````````````````</span></span>
<span id="cb161-72"><a href="#cb161-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-73"><a href="#cb161-73" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select pub_name, type, avg(price), count(*), min(price), max(price), sum(price)</span></span>
<span id="cb161-74"><a href="#cb161-74" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles join publishers on titles.pub_id = publishers.pub_id</span></span>
<span id="cb161-75"><a href="#cb161-75" aria-hidden="true" tabindex="-1"></a><span class="st">      group by pub_name</span></span>
<span id="cb161-76"><a href="#cb161-76" aria-hidden="true" tabindex="-1"></a><span class="st">      order by pub_name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              pub_name      type avg(price) count(*) min(price) max(price) sum(price)
1       AAA Publishing biography     10.490        3       7.99      12.99      20.98
2    Abatis Publishers   history     14.305        6       6.95      21.99      85.83
3      Core Dump Books  computer     39.950        1      39.95      39.95      39.95
4 Schandenfreude Press   history     24.630        3      19.95      29.99      73.89</code></pre>
</div>
</div>
</section>
<section id="having-clause" class="level2" data-number="18.23">
<h2 data-number="18.23" class="anchored" data-anchor-id="having-clause"><span class="header-section-number">18.23</span> HAVING clause</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HAVING </span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="co">#    group by COLUMN1, COLUMN2, ...</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="co">#    having SOME_LOGICAL_EXPRESSION</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Select statements that contain a "group by" MAY ALSO contain an optional "having clause".</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Select statements that do not contain a "group by" may NOT contain "having"</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Both "where" and "having" clauses contain logical expression. </span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Where an having clauses differ in the following ways:</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. "where"  eliminates individual rows from the original table that do not meet the conditions.</span></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    "having" eliminates entire groups of rows that do not meet its conditions.</span></span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. "where" may refer to any columns in the original tables, but may NOT refer to aggregate functions.</span></span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a><span class="co">#    "having" may ONLY refer to aggregate functions and column names that appear in the group by clause.</span></span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb163-23"><a href="#cb163-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-24"><a href="#cb163-24" aria-hidden="true" tabindex="-1"></a><span class="co"># show all the data from the titles table</span></span>
<span id="cb163-25"><a href="#cb163-25" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select * </span></span>
<span id="cb163-26"><a href="#cb163-26" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb163-27"><a href="#cb163-27" aria-hidden="true" tabindex="-1"></a><span class="st">       order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   title_id                          title_name       type pub_id pages price   sales         pubdate
1       T06                    How About Never?  biography    P01   473 19.95   11320  7/31/2000 0:00
2       T07                   I Blame My Mother  biography    P03   333 23.95 1500200  10/1/1999 0:00
3       T10         Not Without My Fabrerge Egg  biography    P05    NA    NA      NA            &lt;NA&gt;
4       T12           Spontaneous, Not Annoying  biography    P05   507 12.99  100001  8/31/2000 0:00
5       T08        Just Wait Until After School   children    P01    86 10.00    4095   6/1/2001 0:00
6       T09                     Kiss My Boo Boo   children    P01    22 13.95    5000  5/31/2002 0:00
7       T03        Ask Yor System Administrator   computer    P02  1226 39.95   25667   9/1/2000 0:00
8       T01                               1977!    history    P01   107 21.99     566   8/1/2000 0:00
9       T02           200 Years of German Humor    history    P03    14 19.95    9566   4/1/1998 0:00
10      T13 What Are The Civilian Applications?    history    P03   802 29.99   10467  5/31/1999 0:00
11      T04           But I Did It Unconciously psychology    P01   510 12.99   13001  5/31/1999 0:00
12      T05              Exchange of Platitudes psychology    P01   201  6.95  201440   1/1/2001 0:00
13      T11    Perhaps It's a Glandular Problem psychology    P05   826  7.99   94123 11/30/2000 0:00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Without having</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, avg(price), count(*), min(price), max(price), sum(price)</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="st">      order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type avg(price) count(*) min(price) max(price) sum(price)
1  biography   18.96333        4      12.99      23.95      56.89
2   children   11.97500        2      10.00      13.95      23.95
3   computer   39.95000        1      39.95      39.95      39.95
4    history   23.97667        3      19.95      29.99      71.93
5 psychology    9.31000        3       6.95      12.99      27.93</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same query WITH THE ADDITION of "having" (note that having must come before "order by")</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that the rows for groups that don't satisfy the having conditions </span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co"># are eliminated from the output.</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, avg(price), count(*), min(price), max(price), sum(price)</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a><span class="st">      having count(*) &gt;=3 </span></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a><span class="st">      order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type avg(price) count(*) min(price) max(price) sum(price)
1  biography   18.96333        4      12.99      23.95      56.89
2    history   23.97667        3      19.95      29.99      71.93
3 psychology    9.31000        3       6.95      12.99      27.93</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can see the effect of the having in the above query by running</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the same query WITHOUT the having</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, avg(price), count(*), min(price), max(price), sum(price)</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="st">      order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type avg(price) count(*) min(price) max(price) sum(price)
1  biography   18.96333        4      12.99      23.95      56.89
2   children   11.97500        2      10.00      13.95      23.95
3   computer   39.95000        1      39.95      39.95      39.95
4    history   23.97667        3      19.95      29.99      71.93
5 psychology    9.31000        3       6.95      12.99      27.93</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The having clause's logical expression can be as complex as you want.</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify the previous select to show only types of books for which</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - there are at least 3 books of that type</span></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="co">#        and also </span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - the avg price is at least $20 or is less than or equal to  $10</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, avg(price), count(*), min(price), max(price), sum(price)</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="st">      from titles</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a><span class="st">      group by type</span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a><span class="st">      having count(*) &gt;=3 and (avg(price) &gt;= 20 or avg(price) &lt;= 10)</span></span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a><span class="st">      order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type avg(price) count(*) min(price) max(price) sum(price)
1    history   23.97667        3      19.95      29.99      71.93
2 psychology    9.31000        3       6.95      12.99      27.93</code></pre>
</div>
</div>
</section>
<section id="using-where-and-having-in-the-same-query---a-detailed-analysis" class="level2" data-number="18.24">
<h2 data-number="18.24" class="anchored" data-anchor-id="using-where-and-having-in-the-same-query---a-detailed-analysis"><span class="header-section-number">18.24</span> using where and having in the same query - a detailed analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using where and having in the same query</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="co"># When a query runs the processing of the raw data in to the</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co"># final output happens in the following logical order</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   - FROM: all of the data from the tables is retrieved and joined into </span></span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a><span class="co">#           a single "mega-table" (mega-table is NOT a standard word). </span></span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   - WHERE: the where clause eliminates rows from this "mega-table" that</span></span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a><span class="co">#            do not satisfy the where's logical expression</span></span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   - GROUP BY: the remaining rows a "grouped" by the group by clause</span></span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   - HAINVG:   the having clause works to eliminate groups that don't </span></span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a><span class="co">#               satisfy the having clause's logical expression</span></span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    </span></span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   - SELECT:   the select clause is used to generate the output of the </span></span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a><span class="co">#               aggregate functions </span></span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   - ORDER BY: the resulting rows are ordered according to the "order by" clause</span></span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   - LIMIT:    only the rows specified by the limit clause are shown</span></span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a><span class="co"># To help you remember this, the clauses in a select statement must be specified</span></span>
<span id="cb173-26"><a href="#cb173-26" aria-hidden="true" tabindex="-1"></a><span class="co"># in the above order - EXCEPT that the select clause must be listed first. The designers</span></span>
<span id="cb173-27"><a href="#cb173-27" aria-hidden="true" tabindex="-1"></a><span class="co"># of SQL thought that since the select clause specifies which column appear in the </span></span>
<span id="cb173-28"><a href="#cb173-28" aria-hidden="true" tabindex="-1"></a><span class="co"># output it is important to see it first ...</span></span>
<span id="cb173-29"><a href="#cb173-29" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb173-30"><a href="#cb173-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that the where clause eliminates rows from the original tables</span></span>
<span id="cb173-31"><a href="#cb173-31" aria-hidden="true" tabindex="-1"></a><span class="co"># BEFORE the having clause eliminates groups. This can have an effect on the output</span></span>
<span id="cb173-32"><a href="#cb173-32" aria-hidden="true" tabindex="-1"></a><span class="co"># of queries that use both the where and having clauses.</span></span>
<span id="cb173-33"><a href="#cb173-33" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb173-34"><a href="#cb173-34" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################################################</span></span>
<span id="cb173-35"><a href="#cb173-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-36"><a href="#cb173-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-37"><a href="#cb173-37" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------</span></span>
<span id="cb173-38"><a href="#cb173-38" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the following queries WITHOUT having</span></span>
<span id="cb173-39"><a href="#cb173-39" aria-hidden="true" tabindex="-1"></a><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb173-40"><a href="#cb173-40" aria-hidden="true" tabindex="-1"></a><span class="co"># The numbers are different in the 2nd query since </span></span>
<span id="cb173-41"><a href="#cb173-41" aria-hidden="true" tabindex="-1"></a><span class="co"># the where clause eliminated specific rows.</span></span>
<span id="cb173-42"><a href="#cb173-42" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb173-43"><a href="#cb173-43" aria-hidden="true" tabindex="-1"></a><span class="co"># After the where clause runs there are no childrens books</span></span>
<span id="cb173-44"><a href="#cb173-44" aria-hidden="true" tabindex="-1"></a><span class="co"># left and there are fewer biograph, history and psychology books.</span></span>
<span id="cb173-45"><a href="#cb173-45" aria-hidden="true" tabindex="-1"></a><span class="co"># The min and max page counts also are different to match the </span></span>
<span id="cb173-46"><a href="#cb173-46" aria-hidden="true" tabindex="-1"></a><span class="co"># books that are left after the where ran.</span></span>
<span id="cb173-47"><a href="#cb173-47" aria-hidden="true" tabindex="-1"></a><span class="co"># The only group that wasn't affected by the where was the</span></span>
<span id="cb173-48"><a href="#cb173-48" aria-hidden="true" tabindex="-1"></a><span class="co"># computer books.</span></span>
<span id="cb173-49"><a href="#cb173-49" aria-hidden="true" tabindex="-1"></a><span class="co">#  </span></span>
<span id="cb173-50"><a href="#cb173-50" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------</span></span>
<span id="cb173-51"><a href="#cb173-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-52"><a href="#cb173-52" aria-hidden="true" tabindex="-1"></a><span class="co"># group by ..</span></span>
<span id="cb173-53"><a href="#cb173-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-54"><a href="#cb173-54" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, count(*), count(pages), min(pages), max(pages)</span></span>
<span id="cb173-55"><a href="#cb173-55" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb173-56"><a href="#cb173-56" aria-hidden="true" tabindex="-1"></a><span class="st">       GROUP BY TYPE</span></span>
<span id="cb173-57"><a href="#cb173-57" aria-hidden="true" tabindex="-1"></a><span class="st">       order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type count(*) count(pages) min(pages) max(pages)
1  biography        4            3        333        507
2   children        2            2         22         86
3   computer        1            1       1226       1226
4    history        3            3         14        802
5 psychology        3            3        201        826</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># where ...</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="co"># group by ..</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, count(*), count(pages), min(pages), max(pages)</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="st">       WHERE PAGES &gt; 350</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="st">       GROUP BY TYPE</span></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="st">       order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type count(*) count(pages) min(pages) max(pages)
1  biography        2            2        473        507
2   computer        1            1       1226       1226
3    history        1            1        802        802
4 psychology        2            2        510        826</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------------------------</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's see the actual rows that were affected by the where clause.</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll do so by running a similar query WIHTOUT the GROUP BY.</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We will display the actual data for each row.</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="co"># See the rows that were processed by the 1st query above.</span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, pages, title_name</span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a><span class="st">       order by type, pages, title_name</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         type pages                          title_name
1   biography    NA         Not Without My Fabrerge Egg
2   biography   333                   I Blame My Mother
3   biography   473                    How About Never?
4   biography   507           Spontaneous, Not Annoying
5    children    22                     Kiss My Boo Boo
6    children    86        Just Wait Until After School
7    computer  1226        Ask Yor System Administrator
8     history    14           200 Years of German Humor
9     history   107                               1977!
10    history   802 What Are The Civilian Applications?
11 psychology   201              Exchange of Platitudes
12 psychology   510           But I Did It Unconciously
13 psychology   826    Perhaps It's a Glandular Problem</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let's add in the where clause to see the rows that were</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="co"># processed by the 2nd query above.</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, pages, title_name</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="st">       WHERE PAGES &gt; 350</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a><span class="st">       order by type, pages, title_name</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type pages                          title_name
1  biography   473                    How About Never?
2  biography   507           Spontaneous, Not Annoying
3   computer  1226        Ask Yor System Administrator
4    history   802 What Are The Civilian Applications?
5 psychology   510           But I Did It Unconciously
6 psychology   826    Perhaps It's a Glandular Problem</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can now see why we got the results we did when we </span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ran the versions of the queries with the GROUP BY and </span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the aggregate functions.</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="co"># If you use</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     a where clause </span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     and a group by </span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     and a having</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a><span class="co"># The where clause runs then </span></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a><span class="co"># the group by clause runs then</span></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a><span class="co"># the having clause runs</span></span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------</span></span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a><span class="co"># group by ...   (same as the 1st query above)</span></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, count(*), count(pages), min(pages), max(pages)</span></span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a><span class="st">       GROUP BY TYPE</span></span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a><span class="st">       order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type count(*) count(pages) min(pages) max(pages)
1  biography        4            3        333        507
2   children        2            2         22         86
3   computer        1            1       1226       1226
4    history        3            3         14        802
5 psychology        3            3        201        826</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group by ...</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="co"># having ...</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="co"># having gets rid of groups that don't meet it's criteria</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, count(*), count(pages), min(pages), max(pages)</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a><span class="st">       group by type</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a><span class="st">       having count(*) &gt; 1</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a><span class="st">       order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type count(*) count(pages) min(pages) max(pages)
1  biography        4            3        333        507
2   children        2            2         22         86
3    history        3            3         14        802
4 psychology        3            3        201        826</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ADDING IN A WHERE CHANGES THINGS</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="co"># In the following we simply added the line: where pages &gt; 350</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This does two things</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   (a) childrens books don't show up at all - because none are longer than 350 pages</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   (b) only 1 history book shows up - the other 2 history books were shorter then 350 pages</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="co"># where ...</span></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="co"># group by ...</span></span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, count(*), count(pages), min(pages), max(pages)</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a><span class="st">       where pages &gt; 350</span></span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a><span class="st">       group by type</span></span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a><span class="st">       order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type count(*) count(pages) min(pages) max(pages)
1  biography        2            2        473        507
2   computer        1            1       1226       1226
3    history        1            1        802        802
4 psychology        2            2        510        826</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOW - since the where clause was added, the having clause will now</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="co"># also eliminate the history group in addition to the computer group</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="co"># since now the history group also only has 1 title.</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="co"># As a result we are only left with biography and psychology groups.</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="co"># where ...</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a><span class="co"># group by ...</span></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a><span class="co"># having ...</span></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sqldf</span>(<span class="st">"select type, count(*), count(pages), min(pages), max(pages)</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a><span class="st">       from titles</span></span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a><span class="st">       where pages &gt; 350</span></span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a><span class="st">       group by type</span></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a><span class="st">       having count(*) &gt; 1</span></span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a><span class="st">       order by type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        type count(*) count(pages) min(pages) max(pages)
1  biography        2            2        473        507
2 psychology        2            2        510        826</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./sql0035-workingWithMultipleTables-v012.html" class="pagination-link  aria-label=" &lt;span="" joins.&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inner Joins.</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sql0040-crossJoin-leftJoin-subquery-selfJoins-v023.html" class="pagination-link" aria-label="<span class='chapter-number'>19</span>&nbsp; <span class='chapter-title'>more joins (cross/left/right/full), subqueries, set operations, case, self joins</span>">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">more joins (cross/left/right/full), subqueries, set operations, case, self joins</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>